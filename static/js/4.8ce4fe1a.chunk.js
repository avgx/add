(this["webpackJsonpmy-app-ts"]=this["webpackJsonpmy-app-ts"]||[]).push([[4],{818:function(e){e.exports=JSON.parse('[{"id":"7DFA3E61-2410-4D7F-9FA9-286AEC176457","title":"Visitors","raw":[{"id":"3B0CDEA8-8636-4457-8983-A8931DE80596","title":"Visitors by server","visualizeType":"Chart","groupBy":["event.detector.People.state","event.detector.People.phase","source.server"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.People.phase","type":"set","op":"eq","value":"happened"}],"chart":{"type":"Bar","x":"source.server","y":"event.detector.People.phase","op":"count","series":"event.detector.People.state"},"description":"for all servers as bar chart"},{"id":"268B9D0D-1BCD-4AEC-A3F3-A7AE6A752617","title":"Visitors by time","visualizeType":"Chart","groupBy":["event.detector.People.phase","event.detector.People.state","time.min_of_day_x30","time.hour_x2","time.min_of_day_x15"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.People.phase","type":"set","op":"eq","value":"happened"}],"chart":{"type":"Area","x":"time.min_of_day_x15","y":"event.detector.People.phase","op":"count","series":"event.detector.People.state"},"description":"in 15m intervals"},{"id":"35FE34EA-F005-4CEB-B5B7-59A69D0AA077","title":"Visitors by time","visualizeType":"Chart","groupBy":["event.detector.People.phase","event.detector.People.state","time.min_of_day_x30","time.hour_x2","time.min_of_day_x15"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.People.phase","type":"set","op":"eq","value":"happened"}],"chart":{"type":"Area","x":"time.hour_x2","y":"event.detector.People.phase","op":"count","series":"event.detector.People.state"},"description":"in 2h intervals"},{"id":"1BCE883B-ED71-4510-879B-C55A23C53E25","title":"Visitors by time Entered at server TIMUR","visualizeType":"Chart","groupBy":["event.detector.People.phase","event.detector.People.state","time.min_of_day_x30","time.hour_x2","time.min_of_day_x15"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.People.phase","type":"set","op":"eq","value":"happened"},{"field":"source.server","type":"dictionary","op":"eq","value":"TIMUR-SHUGUSHEV"},{"field":"event.detector.People.state","type":"set","op":"eq","value":"in"}],"chart":{"type":"Line","x":"time.min_of_day_x30","y":"event.detector.People.phase","op":"count","series":"event.detector.People.state"},"description":"in 30m intervals"},{"id":"C4563579-6778-439D-9077-9909E986C503","title":"Sample title","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"![](https://www.axxonsoft.com/local/templates/axxonsoft-2019/img/logo.svg)\\n\\n# This is Visitors dashboard\\n\\n#### here is some description\\n\\n[Markdown](http://daringfireball.net/projects/markdown/) lets you write content in a really natural way.\\n\\n  * You can have lists, like this one\\n  * Make things **bold** or *italic*\\n  * Embed snippets of `code`\\n"},{"id":"D8120B30-A644-4C30-B21E-1EEECAF60670","title":"some other title","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"### About layout\\n\\n* The grid layout for dashboard is fixed for 2 items per row.\\n* Widgets are ordered by type.\\n* Order: [ Markdown, Counter, Chart, Pie, Table] \\n* This will be fixed in future"}]},{"id":"580AB752-4F07-4466-A7AD-3B631FA72E89","title":"Gender/Age","raw":[{"id":"F69B7338-B0B8-4563-B10C-C85FBBE6DE37","title":"Average age by server","visualizeType":"Chart","groupBy":["event.detector.faceAppeared.age","event.detector.faceAppeared.gender2","event.detector.faceAppeared.phase","time.hour_x2","source.server","source.video"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.faceAppeared.phase","type":"set","op":"eq","value":"happened"},{"field":"event.detector.faceAppeared.age","type":"number","op":"gt","value":"0"}],"chart":{"type":"Bar","x":"event.detector.faceAppeared.gender2","y":"event.detector.faceAppeared.age","op":"avg","series":"source.server"}},{"id":"F1F30966-8A87-483C-8F1B-44202CE2A56D","title":"Male","visualizeType":"Counter","groupBy":["event.detector.faceAppeared.age","event.detector.faceAppeared.gender2","event.detector.faceAppeared.phase","time.hour_x2","source.server","source.video"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.faceAppeared.phase","type":"set","op":"eq","value":"happened"},{"field":"event.detector.faceAppeared.gender2","type":"set","op":"eq","value":"male"}],"chart":{"type":"Bar","x":"event.detector.faceAppeared.gender2","y":"event.detector.faceAppeared.age","op":"avg","series":"source.server"},"counter":{"field":"event.detector.faceAppeared.phase","op":"count"}},{"id":"7FF86C62-430C-46AF-BB3D-EFC00061B812","title":"Female","visualizeType":"Counter","groupBy":["event.detector.faceAppeared.age","event.detector.faceAppeared.gender2","event.detector.faceAppeared.phase","time.hour_x2","source.server","source.video"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.faceAppeared.phase","type":"set","op":"eq","value":"happened"},{"field":"event.detector.faceAppeared.gender2","type":"set","op":"eq","value":"female"}],"chart":{"type":"Bar","x":"event.detector.faceAppeared.gender2","y":"event.detector.faceAppeared.age","op":"avg","series":"source.server"},"counter":{"field":"event.detector.faceAppeared.phase","op":"count"}},{"id":"51DCD0D2-F304-45B7-8A72-C2CE6FF3625C","title":"Genders by server","visualizeType":"Pie","groupBy":["event.detector.faceAppeared.age","event.detector.faceAppeared.gender2","event.detector.faceAppeared.phase","time.hour_x2","source.server","source.video"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.faceAppeared.phase","type":"set","op":"eq","value":"happened"},{"field":"event.detector.faceAppeared.age","type":"number","op":"gt","value":"0"},{"field":"source.server","type":"dictionary","op":"neq","value":"QA-T31"}],"chart":{"type":"Bar","x":"event.detector.faceAppeared.gender2","y":"event.detector.faceAppeared.phase","op":"count","series":"source.server"},"counter":{"field":"event.detector.faceAppeared.phase","op":"count"},"description":"excluding QA-T31"},{"id":"E29DD14B-788A-4D3E-B75B-1BE430687303","title":"some other title","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"### About layout\\n\\n* The grid layout for dashboard is fixed for 2 items per row.\\n* Widgets are ordered by type.\\n* Order: [ Markdown, Counter, Chart, Pie, Table] \\n* This will be fixed in future"},{"id":"929ED66E-BFFC-4133-AB42-9032A739EA01","title":"Sample title","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"![](https://www.axxonsoft.com/local/templates/axxonsoft-2019/img/logo.svg)\\n"}]},{"id":"42D77AE2-1E41-4D05-9924-DD65E7C53A1E","title":"Evasion detection","raw":[{"id":"EA82B93D-93F7-4CBC-BDD3-08A221B89DED","title":"Evasion detected","visualizeType":"Chart","groupBy":["event.detector.type","source.video","source.server","time.hour"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.type","type":"dictionary","op":"eq","value":"EvasionDetected"}],"chart":{"type":"Line","x":"time.hour","y":"event.detector.type","op":"count","series":"source.server"},"description":"by hour by all cameras of server"},{"id":"4B5707C1-D502-4C9C-8FBB-FDEDB5096A6A","title":"Evasion detected","visualizeType":"Chart","groupBy":["event.detector.type","source.video","source.server","time.hour"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.type","type":"dictionary","op":"eq","value":"EvasionDetected"}],"chart":{"type":"Line","x":"time.hour","y":"event.detector.type","op":"count","series":"source.video"},"description":"by hour by cameras"},{"id":"0D40CAC6-5A77-4B05-9FEE-6900F784EE64","title":"Evasion text","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"![](https://www.axxonsoft.com/local/templates/axxonsoft-2019/img/logo.svg)\\n\\n# Evasion detection dashboard\\n\\n### demo\\n"},{"id":"1439ADA3-6FC0-4E71-A855-E91F7AE3F2F9","title":"description text","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"# How it works\\n\\n* The data is taken from events with detectorType=EvasionDetected"},{"id":"428EC59A-4DBE-4983-B676-8AD948142640","title":"Evasion by 15m intervals","visualizeType":"Chart","groupBy":["event.detector.type","source.video","source.server","time.min_of_day_x15"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.type","type":"dictionary","op":"eq","value":"EvasionDetected"}],"chart":{"type":"Area","x":"time.min_of_day_x15","y":"event.detector.type","op":"count","series":"source.server"},"description":"by 15m by all cameras of server"},{"id":"A3C5649F-9E1C-4347-A9EF-A220318AE866","title":"Evasion by 15m intervals","visualizeType":"Chart","groupBy":["event.detector.type","source.video","source.server","time.min_of_day_x15"],"period":{"type":"forever"},"filterItems":[{"field":"event.detector.type","type":"dictionary","op":"eq","value":"EvasionDetected"}],"chart":{"type":"Area","x":"time.min_of_day_x15","y":"event.detector.type","op":"count","series":"source.video"},"description":"by 15m by cameras"}]},{"id":"A906943C-CC39-4C38-AAEF-82D4CF25625A","title":"LPR events (list)","raw":[{"id":"4b4e1346-2653-43cc-a647-6c5365286d57","title":"LPR events","visualizeType":"Events","groupBy":[],"filterItems":[{"field":"event.detector.type","type":"dictionary","op":"eq","value":"plateRecognized"}],"period":{"type":"forever"},"description":"show lpr event with plate recognized"}]},{"id":"C9E18F8B-D2DE-42A0-BFF2-F4A542E69A3B","title":"Faces events (list)","raw":[{"id":"0854b7c4-f7b2-4473-81a1-23769b94118d","title":"Faces","visualizeType":"Events","groupBy":[],"filterItems":[{"field":"event.detector.faceAppeared.phase","type":"set","op":"eq","value":"happened"}],"period":{"type":"forever"},"description":"all events with face appeared"}]},{"id":"5A01EE61-79A7-4C59-A6DC-E048EC432B80","title":"Pivot demo","raw":[{"id":"159483b2-ef82-48e3-9a3f-dd45e44ec6c2","title":"Weekdays distribution","visualizeType":"PivotTable","groupBy":["source.detector","event.detector.type","type","source.video","source.server","time.hour","time.min_of_day_x30","event.detector.faceAppeared.gender2","time.weekday"],"filterItems":[{"field":"type","type":"set","op":"eq","value":"detector"},{"field":"event.detector.faceAppeared.phase","type":"set","op":"eq","value":"happened"}],"period":{"type":"forever"},"pivot":{"rows":"event.detector.faceAppeared.gender2","columns":"time.weekday","values":"type","op":"count"},"description":"male / female by weekdays"},{"id":"159483b2-ef82-48e3-9a3f-dd45e44ec6c2","title":"Detector to video pivot","visualizeType":"PivotTable","groupBy":["source.detector","event.detector.type","type","source.video","source.server"],"filterItems":[{"field":"type","type":"set","op":"eq","value":"detector"}],"period":{"type":"forever"},"pivot":{"rows":"source.detector","columns":"source.video","values":"type","op":"count"},"description":"events count"},{"id":"859483b2-ef82-48e3-9a3f-dd45e44ec6c2","title":"Pivot table sample","visualizeType":"PivotTable","groupBy":["source.detector","event.detector.type","type","source.video","source.server","time.hour","time.min_of_day_x30"],"filterItems":[{"field":"type","type":"set","op":"eq","value":"detector"}],"period":{"type":"forever"},"pivot":{"rows":"time.min_of_day_x30","columns":"source.video","values":"type","op":"count"}}]}]')},819:function(e){e.exports=JSON.parse('[{"id":"tutorial","title":"Tutorial","raw":[{"id":"C4563479-6778-439D-9077-9909E986C503","title":"Sample title","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"![](https://www.axxonsoft.com/local/templates/axxonsoft-2019/img/logo.svg)\\n\\n# This is dashboard tutorial"},{"id":"D3120B30-A644-4C30-B21E-1EEECAF60670","title":"some other title","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"### To be continued\\n\\n[next link](#/dashboard/tutorial-page-1)"}]},{"id":"tutorial-page-1","title":"Tutorial","raw":[{"id":"18120B30-A644-4C30-B21E-1EEECAF60670","title":"some other title","visualizeType":"Markdown","groupBy":[],"period":{"type":"forever"},"filterItems":[],"description":"### To be continued"}]}]')},861:function(e,t,a){"use strict";a.r(t);var n=a(123),r=a(157),l=a(0),i=a.n(l),o=a(113),s=a(856),c=a(477),u=a(478),d=a(104),p=a(105),m=a(107),v=a(106),h=a(108),f=a(865),g=a(377),y=a(376),b=a(825);var E=function(e){return l.createElement(y.a,{variant:"elevation",elevation:0},l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0,spacing:2},l.createElement("div",null,l.createElement(g.a,{id:"title-text",size:"small",label:"Title",value:e.title,onChange:function(t){var a=t.target.value&&""!==t.target.value?t.target.value:"";console.log("newTitleValue "+a),e.onChangeTitle(a)},fullWidth:!0,InputLabelProps:{shrink:!0},variant:"outlined"}))),l.createElement(b.a,{item:!0,spacing:2},l.createElement(g.a,{id:"description-text",size:"small",label:"Description",value:e.description,onChange:function(t){var a=t.target.value&&""!==t.target.value?t.target.value:"";console.log("newDescriptionValue "+a),e.onChangeDescription(a)},fullWidth:!0,multiline:!0,variant:"outlined"}))))},C=a(836),k=a(385),O=a(40),S=a.n(O),w=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={err:void 0},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.api+"/api/v1/ad-dictionary/events/fields?lang="+this.props.lang,a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.props.token}};fetch(t,a).then((function(e){return e.json()})).then((function(t){e.props.onChangeEventFields(t)})).catch((function(t){e.setState({err:t.message})}))}},{key:"render",value:function(){return this.state.err?l.createElement("div",null,l.createElement(b.a,{container:!0,direction:"row",justify:"center",alignItems:"center",style:{height:"90vh",margin:0,padding:0}},l.createElement(b.a,{item:!0},l.createElement(C.a,null,l.createElement(k.a,null,"Error: ",this.state.err))))):l.createElement("div",{style:{height:"90vh",margin:0,padding:0,display:"flex",justifyContent:"center",alignItems:"center"}},l.createElement(S.a,null),"\xa0\xa0Loading event fields...")}}]),t}(l.Component),A=a(271),B=a.n(A),x=a(386),F=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).fetchField1=function(){var e=Object(x.a)(B.a.mark((function e(t){var n,r,l,i;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.descriptor.type,r=t.name,console.log("fetch "+n+" "+r),l=a.props.api+"/api/v2/ad-query/field/"+n+"/"+r,i={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.props.token}},e.abrupt("return",fetch(l,i).catch((function(e){console.log("Error: "+l,e)})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(x.a)(B.a.mark((function e(){var t,a,n,r,l,i,s,c=this;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("WidgetEditorLoadingPossibleValues componentDidMount"),t=this.props.eventFields.filter((function(e){return"set"===e.descriptor.type})),a=this.props.eventFields.filter((function(e){return"dictionary"===e.descriptor.type})),n=new Map,r=new Map,l=Promise.all(t.map(function(){var e=Object(x.a)(B.a.mark((function e(t){var a,r;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.fetchField1(t);case 2:if(!(a=e.sent)||!a.ok){e.next=10;break}return e.next=6,a.json();case 6:r=e.sent,n.set(t.name,r.result),e.next=11;break;case 10:n.set(t.name,[]);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),i=Promise.all(a.map(function(){var e=Object(x.a)(B.a.mark((function e(t){var a,n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.fetchField1(t);case 2:if(!(a=e.sent)||!a.ok){e.next=10;break}return e.next=6,a.json();case 6:n=e.sent,r.set(t.name,n.result),e.next=11;break;case 10:r.set(t.name,[]);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),console.log("before Promise.all"),e.next=10,Promise.all([l,i]);case 10:console.log("after Promise.all"),console.log("setValues="+JSON.stringify(n)),console.log("dictionaryValues="+JSON.stringify(r)),s={set:o.b(n),dictionary:o.b(r)},this.props.onChangePossibleValues(s);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return l.createElement("div",{style:{height:"90vh",margin:0,padding:0,display:"flex",justifyContent:"center",alignItems:"center"}},l.createElement(S.a,null),"\xa0\xa0Loading possible values...")}}]),t}(l.Component),j=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={err:void 0},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.api+"/api/v1/ad-dictionary/timeperiods?lang="+this.props.lang,a={method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.props.token}};fetch(t,a).then((function(e){return e.json()})).then((function(t){e.props.onLoadPossiblePeriods(t)})).catch((function(t){e.setState({err:t.message})}))}},{key:"render",value:function(){return this.state.err?l.createElement("div",null,l.createElement(b.a,{container:!0,direction:"row",justify:"center",alignItems:"center",style:{height:"90vh",margin:0,padding:0}},l.createElement(b.a,{item:!0},l.createElement(C.a,null,l.createElement(k.a,null,"Error: ",this.state.err))))):l.createElement("div",{style:{height:"90vh",margin:0,padding:0,display:"flex",justifyContent:"center",alignItems:"center"}},l.createElement(S.a,null),"\xa0\xa0Loading timeperiods...")}}]),t}(l.Component),D=a(499),T=a(387),I=a(269),P=a(388),W=a(272),N=a.n(W);var V=function(e){var t=l.useState(null),a=Object(r.a)(t,2),n=a[0],i=a[1],s=function(t){return function(){e.onRemoveField(t)}},c=function(t){return function(){e.onAddField(t),i(null)}},u=e.groupBy,d=e.groupByAvailable.filter((function(e){return!u.find((function(t){return t===e.name}))&&"complex"!==e.descriptor.type}));return l.createElement(y.a,{variant:"elevation",elevation:0,title:"Select fields that will be used in the result dataset"},l.createElement(k.a,{variant:"h6"},"Select",l.createElement(T.a,{edge:"end","aria-label":"filter",onClick:function(e){i(e.currentTarget)},title:"Add field"},l.createElement(N.a,null))),o.a(e.groupBy).map((function(t){return a=t,e.groupByAvailable.find((function(e){return e.name===a}));var a})).filter((function(e){return!!e})).map((function(e){return e})).map((function(e){return l.createElement(D.a,{key:e.name,variant:"outlined",size:"small",onDelete:s(e),label:e.translation})})),l.createElement(I.a,{id:"simple-menu",anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:function(){i(null)}},d.map((function(e){return l.createElement(P.a,{key:e.name,onClick:c(e)},e.translation)}))))},z=a(389),M=a(527),J=a.n(M),L=a(842),R=a(843),_=a(844),q=a(839);var U=function(e){var t,a=l.useState(!1),n=Object(r.a)(a,2),i=n[0],s=n[1],c=[{value:"eq",label:"=="},{value:"neq",label:"!="}],u=[{value:"contains",label:"contains"},{value:"notcontains",label:"notcontains"}],d=[{value:"gt",label:">"},{value:"lt",label:"<"},{value:"gte",label:">="},{value:"lte",label:"<="},{value:"eq",label:"=="},{value:"neq",label:"!="}],p=l.useState(""),m=Object(r.a)(p,2),v=m[0],h=m[1],f=l.useState(""),E=Object(r.a)(f,2),C=E[0],O=E[1],S=l.useState(""),w=Object(r.a)(S,2),A=w[0],B=w[1],x=function(t){return function(){console.log("handleDelete "+JSON.stringify(t)),e.onRemoveFilterItem(t)}},F=function(e){console.log("handleSelectValue "+e.target.value);var t=e.target.value&&""!==e.target.value?e.target.value:"";console.log("newValue "+t),B(t)},j=function(){var t;s(!1);var a=null!==(t=o.a(e.groupByAvailable).filter((function(e){return e.name===v})).map((function(e){return e.descriptor.type})).first())&&void 0!==t?t:"",n={field:v,type:a,op:C,value:A};e.onAddFilterItem(n),B(""),O(""),h("")},I=o.a(e.groupByAvailable),W=null!==(t=I.filter((function(e){return e.name===v})).map((function(e){return e.descriptor.type})).first())&&void 0!==t?t:"",N="set"===W&&e.possibleValues.set.has(v)?e.possibleValues.set.get(v):[],V="dictionary"===W&&e.possibleValues.dictionary.has(v)?e.possibleValues.dictionary.get(v):[],M=""!==v&&""!==C&&""!==A,U=o.a(e.filterItems);return console.log(U),l.createElement(y.a,{variant:"elevation",elevation:0,title:"Filter the result dataset"},l.createElement(k.a,{variant:"h6"},"Filter",l.createElement(T.a,{edge:"end","aria-label":"filter",onClick:function(){s(!0)},title:"Add filter"},l.createElement(J.a,null))),U.map((function(t,a){var n,r,i,s,p,m,v=t.field+"."+t.op+"."+t.value,h=null!==(n=I.filter((function(e){return e.name===t.field})).map((function(e){return e.translation})).first())&&void 0!==n?n:t.field,f=null!==(r=I.filter((function(e){return e.name===t.field})).map((function(e){return e.descriptor.type})).first())&&void 0!==r?r:"",g="number"===f?null!==(i=o.a(d).filter((function(e){return e.value===t.op})).map((function(e){return e.label})).first())&&void 0!==i?i:t.op:"set"===f||"dictionary"===f?null!==(s=o.a(c).filter((function(e){return e.value===t.op})).map((function(e){return e.label})).first())&&void 0!==s?s:t.op:"string"===f&&null!==(p=o.a(u).filter((function(e){return e.value===t.op})).map((function(e){return e.label})).first())&&void 0!==p?p:t.op,y=e.possibleValues.dictionary.has(t.field)?e.possibleValues.dictionary.get(t.field):[],b=h+" "+g+" "+("dictionary"===f&&null!==(m=o.a(y).filter((function(e){return e.key===t.value})).map((function(e){return e.value})).first())&&void 0!==m?m:t.value);return l.createElement(D.a,{key:v,variant:"outlined",size:"small",onDelete:x(t),label:b})})),l.createElement(q.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,maxWidth:"xs",fullWidth:!0,"aria-labelledby":"confirmation-dialog-title",open:i},l.createElement(L.a,{id:"confirmation-dialog-title"},"Filter by"),l.createElement(R.a,{dividers:!0},l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"field-textfield",label:""!==W?"Field / "+W:"Field",size:"small",select:!0,fullWidth:!0,value:v,onChange:function(t){console.log("handleSelectField "+t.target.value);var a=e.groupByAvailable.find((function(e){return e.name===t.target.value}));console.log("handleSelectField item "+(null===a||void 0===a?void 0:a.name));var n=t.target.value&&""!==t.target.value?t.target.value:"";console.log("handleSelectField "+n),h(n)},variant:"outlined"},e.groupByAvailable.map((function(e,t){return null!=e.descriptor.childs?null:l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},"number"===W||"string"===W||"set"===W||"dictionary"===W?l.createElement(g.a,{id:"op-value-textfield",label:"op",size:"small",select:!0,fullWidth:!0,value:C,onChange:function(e){console.log("handleSelectOp "+e.target.value);var t=e.target.value&&""!==e.target.value?e.target.value:"";console.log("newOp "+t),O(t)},variant:"outlined"},"number"===W?d.map((function(e,t){return l.createElement(P.a,{key:e.value,value:e.value},e.label)})):null,"set"===W||"dictionary"===W?c.map((function(e,t){return l.createElement(P.a,{key:e.value,value:e.value},e.label)})):null,"string"===W?u.map((function(e,t){return l.createElement(P.a,{key:e.value,value:e.value},e.label)})):null):null),l.createElement(b.a,{item:!0},"number"===W||"string"===W?l.createElement(g.a,{id:"value-textfield",label:"Value",size:"small",fullWidth:!0,value:A,onChange:F,variant:"outlined"}):null,"set"===W?l.createElement(g.a,{id:"value-textfield",label:"Value",size:"small",fullWidth:!0,select:!0,value:A,onChange:F,variant:"outlined"},l.createElement(P.a,{key:"",value:""},"[No value]"),N.map((function(e){return l.createElement(P.a,{key:e,value:e},e)}))):null,"dictionary"===W?l.createElement(g.a,{id:"value-textfield",label:"Value",size:"small",fullWidth:!0,select:!0,value:A,onChange:F,variant:"outlined"},l.createElement(P.a,{key:"",value:""},"[No value]"),V.map((function(e){var t=e.key,a=e.value;return l.createElement(P.a,{key:t,value:t},a)}))):null))),l.createElement(_.a,null,l.createElement(z.a,{autoFocus:!0,onClick:function(){s(!1)},color:"primary"},"Cancel"),M?l.createElement(z.a,{onClick:j,color:"primary"},"Ok"):l.createElement(z.a,{onClick:j,disabled:!0,color:"primary"},"Ok"))))};var G=function(e){var t=e.possiblePeriods;return l.createElement("div",{className:"QueryEditorTimeperiod"},l.createElement(g.a,{id:"outlined-select-timeperiod",size:"small",select:!0,label:"Timeperiod",variant:"outlined",onChange:function(a){var n;console.log("handleTimeperiod "+a.target.value);var r=null!==(n=t.find((function(e){return e.type===a.target.value})))&&void 0!==n?n:t[0];console.log("handleSelectSerie item "+(null===r||void 0===r?void 0:r.type)),e.onTimeperiod(r)},value:e.period.type},e.possiblePeriods.map((function(e,t){return l.createElement(P.a,{key:e.type,value:e.type},e.translation)}))))};var Y=function(e){return l.createElement(y.a,{variant:"elevation",elevation:0,title:"Create query by selecting fields of the result dataset in 'Select' section and filter the result dataset by filters from 'Filter' section"},l.createElement(k.a,{variant:"h5"},"Query"),l.createElement(b.a,{container:!0,spacing:2,alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(V,{groupBy:e.groupBy,groupByAvailable:e.groupByAvailable,onAddField:e.onAddField,onRemoveField:e.onRemoveField})),l.createElement(b.a,{item:!0},l.createElement(U,{filterItems:e.filterItems,possibleValues:e.possibleValues,groupByAvailable:e.groupByAvailable,onAddFilterItem:e.onAddFilterItem,onRemoveFilterItem:e.onRemoveFilterItem})),l.createElement(b.a,{item:!0},l.createElement(G,{period:e.period,possiblePeriods:e.possiblePeriods,onTimeperiod:e.onTimeperiod}))))))};var X=function(e){return l.createElement(y.a,{variant:"elevation",elevation:0,title:"Choose vizualization (widget) type"},l.createElement(g.a,{id:"outlined-select-currency",size:"small",select:!0,fullWidth:!0,label:"VisualizeType",variant:"outlined",onChange:e.onChange,value:e.value},l.createElement(P.a,{key:"Events",value:"Events"},"Events"),l.createElement(P.a,{key:"Table",value:"Table"},"Aggregation"),l.createElement(P.a,{key:"PivotTable",value:"PivotTable"},"Pivot"),l.createElement(P.a,{key:"Chart",value:"Chart"},"Chart"),l.createElement(P.a,{key:"Pie",value:"Pie"},"Pie"),l.createElement(P.a,{key:"Counter",value:"Counter"},"Counter"),l.createElement(P.a,{key:"Markdown",value:"Markdown"},"Markdown")))},H=a(390),Q=a(845);var K=function(e){var t,a,r,i,s,c,u,d,p,m,v,h,f,E=function(t){return e.groupByAvailable.find((function(e){return e.name===t}))},C=e.groupBy.map((function(e){return E(e)})).filter((function(e){return!!e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.chart)||void 0===a?void 0:a.y)||t.name===(null===(n=e.chart)||void 0===n?void 0:n.series))})),O=e.groupBy.map((function(e){return E(e)})).filter((function(e){return!!e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.chart)||void 0===a?void 0:a.x)||t.name===(null===(n=e.chart)||void 0===n?void 0:n.series))})),S=e.groupBy.map((function(e){return E(e)})).filter((function(e){return!!e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.chart)||void 0===a?void 0:a.x)||t.name===(null===(n=e.chart)||void 0===n?void 0:n.y))})),w=o.a(e.groupBy).map((function(e){return E(e)})).filter((function(e){return!!e})).map((function(e){return e})),A=null!==(t=w.filter((function(t){var a;return t.name===(null===(a=e.chart)||void 0===a?void 0:a.x)})).map((function(e){return e.descriptor.type})).first())&&void 0!==t?t:"",B=null!==(a=w.filter((function(t){var a;return t.name===(null===(a=e.chart)||void 0===a?void 0:a.y)})).map((function(e){return e.descriptor.type})).first())&&void 0!==a?a:"",x=null!==(r=w.filter((function(t){var a;return t.name===(null===(a=e.chart)||void 0===a?void 0:a.series)})).map((function(e){return e.descriptor.type})).first())&&void 0!==r?r:"",F="number"!==B?["count"]:["count","avg","sum","min","max"];return l.createElement(y.a,{variant:"elevation",elevation:0,title:"Widget type: Chart. To build chart it is required to select which field be at axis x, which field be at axis y and how it must be aggregated, which field will form series"},l.createElement(k.a,{variant:"h6"},"Chart"),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"type-outlined-text",label:"Type",size:"small",select:!0,fullWidth:!0,value:null===(i=e.chart)||void 0===i?void 0:i.type,onChange:function(t){console.log("handleSelectType "+t.target.value);var a=Object(n.a)({},e.chart,{type:t.target.value});e.onChartChange(a)},variant:"outlined"},["Line","Bar","Area"].map((function(e){return l.createElement(P.a,{key:e,value:e},e)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"x-outlined-text",label:""!==A?"X Field / "+A:"X Field",size:"small",select:!0,fullWidth:!0,value:null!==(s=null===(c=e.chart)||void 0===c?void 0:c.x)&&void 0!==s?s:"",onChange:function(t){console.log("handleSelectX "+t.target.value);var a=e.groupBy.map((function(e){return E(e)})).filter((function(e){return!!e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectX item "+(null===a||void 0===a?void 0:a.name));var r=t.target.value&&""!==t.target.value?t.target.value:void 0,l=Object(n.a)({},e.chart,{x:r});e.onChartChange(l)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),C.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"y-outlined-text",label:""!==B?"Y Field / "+B:"Y Field",size:"small",select:!0,fullWidth:!0,value:null!==(u=null===(d=e.chart)||void 0===d?void 0:d.y)&&void 0!==u?u:"",onChange:function(t){var a;console.log("handleSelectY "+t.target.value);var r=e.groupBy.map((function(e){return E(e)})).filter((function(e){return!!e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectY item "+(null===r||void 0===r?void 0:r.name));var l=t.target.value&&""!==t.target.value?t.target.value:void 0,i="number"!==(null===r||void 0===r?void 0:r.descriptor.type)?"count":null===(a=e.chart)||void 0===a?void 0:a.op,o=Object(n.a)({},e.chart,{y:l,op:i});e.onChartChange(o)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),O.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"value-outlined-text",label:"Value op",size:"small",select:!0,fullWidth:!0,value:null===(p=e.chart)||void 0===p?void 0:p.op,onChange:function(t){console.log("handleSelectYOp "+t.target.value);var a=Object(n.a)({},e.chart,{op:t.target.value});e.onChartChange(a)},variant:"outlined"},F.map((function(e){return l.createElement(P.a,{key:e,value:e},e)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"series-outlined-text",label:""!==x?"Series Field / "+x:"Series Field",size:"small",select:!0,fullWidth:!0,value:null!==(m=null===(v=e.chart)||void 0===v?void 0:v.series)&&void 0!==m?m:"",onChange:function(t){console.log("handleSelectSerie "+t.target.value);var a=e.groupBy.map((function(e){return E(e)})).filter((function(e){return!!e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectSerie item "+(null===a||void 0===a?void 0:a.name));var r=t.target.value&&""!==t.target.value?t.target.value:void 0,l=Object(n.a)({},e.chart,{series:r});e.onChartChange(l)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),S.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(H.a,{control:l.createElement(Q.a,{checked:null!==(h=null===(f=e.chart)||void 0===f?void 0:f.brush)&&void 0!==h&&h,onChange:function(t){console.log("handleBrush "+t.target.value);var a=t.target.checked,r=Object(n.a)({},e.chart,{brush:a});e.onChartChange(r)},size:"small"}),label:"Brush"}))))};var Z=function(e){var t,a,r,i,s,c,u,d,p,m,v=function(t){return e.groupByAvailable.find((function(e){return e.name===t}))},h=e.groupBy.map((function(e){return v(e)})).filter((function(e){return null!=e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.chart)||void 0===a?void 0:a.y)||t.name===(null===(n=e.chart)||void 0===n?void 0:n.series))})),f=e.groupBy.map((function(e){return v(e)})).filter((function(e){return null!=e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.chart)||void 0===a?void 0:a.x)||t.name===(null===(n=e.chart)||void 0===n?void 0:n.series))})),y=e.groupBy.map((function(e){return v(e)})).filter((function(e){return null!=e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.chart)||void 0===a?void 0:a.x)||t.name===(null===(n=e.chart)||void 0===n?void 0:n.y))})),E=o.a(e.groupBy).map((function(e){return v(e)})).filter((function(e){return!!e})).map((function(e){return e})),C=null!==(t=E.filter((function(t){var a;return t.name===(null===(a=e.chart)||void 0===a?void 0:a.x)})).map((function(e){return e.descriptor.type})).first())&&void 0!==t?t:"",O=null!==(a=E.filter((function(t){var a;return t.name===(null===(a=e.chart)||void 0===a?void 0:a.y)})).map((function(e){return e.descriptor.type})).first())&&void 0!==a?a:"",S=null!==(r=E.filter((function(t){var a;return t.name===(null===(a=e.chart)||void 0===a?void 0:a.series)})).map((function(e){return e.descriptor.type})).first())&&void 0!==r?r:"",w="number"!==O?["count"]:["count","avg","sum","min","max"];return l.createElement("div",{title:"VisualizeType"},l.createElement(k.a,{variant:"h6"},"Pie"),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"x-outlined-text",label:""!==C?"Name Field / "+C:"Name Field",size:"small",select:!0,fullWidth:!0,value:null!==(i=null===(s=e.chart)||void 0===s?void 0:s.x)&&void 0!==i?i:"",onChange:function(t){console.log("handleSelectX "+t.target.value);var a=e.groupBy.map((function(e){return v(e)})).filter((function(e){return null!=e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectX item "+(null===a||void 0===a?void 0:a.name));var r=t.target.value&&""!==t.target.value?t.target.value:void 0,l=Object(n.a)({},e.chart,{x:r});e.onChartChange(l)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),h.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"series-outlined-text",label:""!==S?"Detail Field / "+S:"Detail Field",size:"small",select:!0,fullWidth:!0,value:null!==(c=null===(u=e.chart)||void 0===u?void 0:u.series)&&void 0!==c?c:"",onChange:function(t){console.log("handleSelectSerie "+t.target.value);var a=e.groupBy.map((function(e){return v(e)})).filter((function(e){return null!=e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectSerie item "+(null===a||void 0===a?void 0:a.name));var r=t.target.value&&""!==t.target.value?t.target.value:void 0,l=Object(n.a)({},e.chart,{series:r});e.onChartChange(l)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),y.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"y-outlined-text",label:""!==O?"Value Field / "+O:"Value Field",size:"small",select:!0,fullWidth:!0,value:null!==(d=null===(p=e.chart)||void 0===p?void 0:p.y)&&void 0!==d?d:"",onChange:function(t){var a;console.log("handleSelectY "+t.target.value);var r=e.groupBy.map((function(e){return v(e)})).filter((function(e){return null!=e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectY item "+(null===r||void 0===r?void 0:r.name));var l=t.target.value&&""!==t.target.value?t.target.value:void 0,i="number"!==(null===r||void 0===r?void 0:r.descriptor.type)?"count":null===(a=e.chart)||void 0===a?void 0:a.op,o=Object(n.a)({},e.chart,{y:l,op:i});e.onChartChange(o)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),f.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"value-outlined-text",label:"Value op",size:"small",select:!0,fullWidth:!0,value:null===(m=e.chart)||void 0===m?void 0:m.op,onChange:function(t){console.log("handleSelectYOp "+t.target.value);var a=Object(n.a)({},e.chart,{op:t.target.value});e.onChartChange(a)},variant:"outlined"},w.map((function(e){return l.createElement(P.a,{key:e,value:e},e)}))))))},$=["count","avg","sum","min","max"],ee=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).handleSelectField=function(e){var t,r;console.log("handleSelectField "+e.target.value);var l=Object(n.a)({},a.props.counter,{field:e.target.value,op:null!==(t=null===(r=a.props.counter)||void 0===r?void 0:r.op)&&void 0!==t?t:"count"});a.props.onCounterChange(l)},a.handleSelectFieldGroupBy=function(e){var t,r;console.log("handleSelectFieldGroupBy "+e.target.value);var l=Object(n.a)({},a.props.counter,{fieldGroupBy:e.target.value,op:null!==(t=null===(r=a.props.counter)||void 0===r?void 0:r.op)&&void 0!==t?t:"count"});a.props.onCounterChange(l)},a.handleSelectOp=function(e){console.log("handleSelectYOp "+e.target.value);var t=Object(n.a)({},a.props.counter,{op:e.target.value});a.props.onCounterChange(t)},a.handleOffsetValue=function(e){console.log("handleOffsetValue "+e.target.value);var t=Object(n.a)({},a.props.counter,{offset:Number(e.target.value)});a.props.onCounterChange(t)},a.handleWithReferenceValue=function(e){var t,r;console.log("handleWithReferenceValue "+e.target.value);var l=e.target.checked,i=Object(n.a)({},a.props.counter,{referenceValue:l?0:void 0,referenceOp:l?null!==(t=null===(r=a.props.counter)||void 0===r?void 0:r.referenceOp)&&void 0!==t?t:"eq":void 0});a.props.onCounterChange(i)},a.handleReferenceValue=function(e){console.log("handleReferenceValue "+e.target.value);var t=Object(n.a)({},a.props.counter,{referenceValue:Number(e.target.value)});a.props.onCounterChange(t)},a.handleReferenceOp=function(e){console.log("handleSelectYOp "+e.target.value);var t=Object(n.a)({},a.props.counter,{referenceOp:e.target.value});a.props.onCounterChange(t)},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e,t,a,n,r,i,s,c,u=this,d=function(e){return u.props.groupByAvailable.find((function(t){return t.name===e}))},p=null!==(e=o.a(this.props.groupBy).map((function(e){return d(e)})).filter((function(e){return!!e})).map((function(e){return e})).filter((function(e){var t;return e.name===(null===(t=u.props.counter)||void 0===t?void 0:t.field)})).map((function(e){return e.descriptor.type})).first())&&void 0!==e?e:"",m="number"!==p?["count"]:$,v="number"===p,h=void 0!==(null===(t=this.props.counter)||void 0===t?void 0:t.referenceValue);return l.createElement("div",null,l.createElement(k.a,{variant:"h6"},"Counter"),l.createElement(k.a,{variant:"subtitle2"},"Note: result must contain only 1 item. This can be achived via filters."),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"value-outlined-text",label:""!==p?"Field / "+p:"Field",size:"small",select:!0,fullWidth:!0,value:null===(a=this.props.counter)||void 0===a?void 0:a.field,onChange:this.handleSelectField,variant:"outlined"},this.props.groupBy.map((function(e){return d(e)})).filter((function(e){return!!e})).map((function(e){return e})).map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"value-outlined-text",label:"Value op",size:"small",select:!0,fullWidth:!0,value:null===(n=this.props.counter)||void 0===n?void 0:n.op,onChange:this.handleSelectOp,variant:"outlined"},m.map((function(e){return l.createElement(P.a,{key:e,value:e},e)})))),v?l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"value-outlined-text",label:"Group by",size:"small",select:!0,fullWidth:!0,value:null===(r=this.props.counter)||void 0===r?void 0:r.fieldGroupBy,onChange:this.handleSelectFieldGroupBy,variant:"outlined"},this.props.groupBy.map((function(e){return d(e)})).filter((function(e){return!!e})).map((function(e){return e})).filter((function(e){return"set"===e.descriptor.type||"dictionary"===e.descriptor.type})).map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))):null,l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"offset-outlined-number",label:"Offset",size:"small",fullWidth:!0,defaultValue:0,value:null===(i=this.props.counter)||void 0===i?void 0:i.offset,onChange:this.handleOffsetValue,type:"number",InputLabelProps:{shrink:!0},variant:"outlined"})),l.createElement(b.a,{item:!0},l.createElement(H.a,{control:l.createElement(Q.a,{checked:h,onChange:this.handleWithReferenceValue,size:"small"}),label:"Highlight if"})),h?l.createElement(b.a,{item:!0},l.createElement(b.a,{container:!0,spacing:2,direction:"row",alignItems:"stretch"},l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(k.a,null,"Value")),l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(g.a,{id:"op-value-textfield",label:"compare operation",size:"small",select:!0,fullWidth:!0,value:null===(s=this.props.counter)||void 0===s?void 0:s.referenceOp,onChange:this.handleReferenceOp,variant:"outlined"},[{value:"gt",label:">"},{value:"lt",label:"<"},{value:"gte",label:">="},{value:"lte",label:"<="},{value:"eq",label:"=="},{value:"neq",label:"!="}].map((function(e,t){return l.createElement(P.a,{key:e.value,value:e.value},e.label)})))),l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(g.a,{id:"reference-outlined-number",label:"Reference",size:"small",fullWidth:!0,value:null===(c=this.props.counter)||void 0===c?void 0:c.referenceValue,onChange:this.handleReferenceValue,type:"number",InputLabelProps:{shrink:!0},variant:"outlined"})))):null))}}]),t}(l.Component),te=a(834),ae=a(838),ne=a(391),re=["count","avg","sum","min","max"],le=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).handleSelectField=function(e){console.log("handleSelectField "+e.target.value);var t=Object(n.a)({},a.props.table,{field:e.target.value});a.props.onTableChange(t)},a.handleSelectOp=function(e){console.log("handleSelectYOp "+e.target.value);var t=Object(n.a)({},a.props.table,{op:e.target.value});a.props.onTableChange(t)},a.handleAggregationFieldInGroupBy=function(e){console.log("handleAggregationFieldInGroupBy "+e.target.value);var t=e.target.checked,r=Object(n.a)({},a.props.table,{isAggregationFieldInGroupBy:t});a.props.onTableChange(r)},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e,t,a,n,r,i,s,c,u,d,p=this,m=o.a(this.props.groupBy).map((function(e){return t=e,p.props.groupByAvailable.find((function(e){return e.name===t}));var t})).filter((function(e){return!!e})).map((function(e){return e})),v=null!==(e=null!==(t=null===(a=this.props.table)||void 0===a?void 0:a.field)&&void 0!==t?t:o.a(this.props.groupBy).first())&&void 0!==e?e:"",h=null!==(n=m.filter((function(e){return e.name===v})).map((function(e){return e.descriptor.type})).first())&&void 0!==n?n:"",f="number"!==h?["count"]:re,y=f.includes(null!==(r=null===(i=this.props.table)||void 0===i?void 0:i.op)&&void 0!==r?r:"")&&null!==(s=null===(c=this.props.table)||void 0===c?void 0:c.op)&&void 0!==s?s:"count";return l.createElement("div",{title:"VisualizeTypeTable"},l.createElement(k.a,{variant:"h6"},"Group by"),l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(te.a,null,m.map((function(e){return l.createElement(ae.a,{dense:!0,key:e.name},l.createElement(ne.a,{primary:e.translation,secondary:e.descriptor.type}))})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"value-outlined-text",label:""!==h?"Aggregate by / "+h:"Aggregate by",size:"small",select:!0,fullWidth:!0,value:v,onChange:this.handleSelectField,variant:"outlined"},m.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"value-outlined-text",label:"Aggregate op",size:"small",select:!0,fullWidth:!0,value:y,onChange:this.handleSelectOp,variant:"outlined"},f.map((function(e){return l.createElement(P.a,{key:e,value:e},e)})))),l.createElement(b.a,{item:!0},l.createElement(H.a,{control:l.createElement(Q.a,{checked:null!==(u=null===(d=this.props.table)||void 0===d?void 0:d.isAggregationFieldInGroupBy)&&void 0!==u&&u,onChange:this.handleAggregationFieldInGroupBy,size:"small"}),label:"Include aggregation field in group by"}))))}}]),t}(l.Component),ie=a(495),oe=a(210),se=a.n(oe);var ce=function(e){var t,a,r,i,s,c,u,d,p,m,v,h,f,y,E,C,O,S,w,A,B,x,F,j,D,T,I,W,N,V,z,M,J,L=function(t){return e.groupByAvailable.find((function(e){return e.name===t}))},R=e.groupBy.map((function(e){return L(e)})).filter((function(e){return!!e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.pivot)||void 0===a?void 0:a.values)||t.name===(null===(n=e.pivot)||void 0===n?void 0:n.columns))})),_=e.groupBy.map((function(e){return L(e)})).filter((function(e){return!!e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.pivot)||void 0===a?void 0:a.rows)||t.name===(null===(n=e.pivot)||void 0===n?void 0:n.values))})),q=e.groupBy.map((function(e){return L(e)})).filter((function(e){return!!e})).map((function(e){return e})).filter((function(t){var a,n;return!(t.name===(null===(a=e.pivot)||void 0===a?void 0:a.rows)||t.name===(null===(n=e.pivot)||void 0===n?void 0:n.columns))})),U=o.a(e.groupBy).map((function(e){return L(e)})).filter((function(e){return!!e})).map((function(e){return e})),G=null!==(t=U.filter((function(t){var a;return t.name===(null===(a=e.pivot)||void 0===a?void 0:a.rows)})).map((function(e){return e.descriptor.type})).first())&&void 0!==t?t:"",Y=null!==(a=U.filter((function(t){var a;return t.name===(null===(a=e.pivot)||void 0===a?void 0:a.columns)})).map((function(e){return e.descriptor.type})).first())&&void 0!==a?a:"",X=null!==(r=U.filter((function(t){var a;return t.name===(null===(a=e.pivot)||void 0===a?void 0:a.values)})).map((function(e){return e.descriptor.type})).first())&&void 0!==r?r:"",K="number"!==X?["count"]:["count","avg","sum","min","max"],Z=null!==(i=null===(s=e.pivot)||void 0===s?void 0:s.columns)&&void 0!==i?i:"",$=Y,ee=[];"set"===$?ee=(null===(J=e.possibleValues.set.get(Z))||void 0===J?void 0:J.map((function(e){return{key:e,value:e}})))||[]:"dictionary"===$&&(ee=(ee=e.possibleValues.dictionary.get(Z)||[]).map((function(e){return{key:e.key,value:e.value&&""!==e.value?e.value:e.key}}))),console.log("columnsValues = "+JSON.stringify(ee));var te=ee,ae=ee,ne=[{key:"*",value:"*"}].concat(ee),re=void 0!==(null===(c=e.pivot)||void 0===c?void 0:c.referenceValue);return l.createElement("div",{title:"VisualizeTypePivotTable"},l.createElement(k.a,{variant:"h6"},"Pivot table"),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"rows-outlined-text",label:""!==G?"Rows Field / "+G:"Rows Field",size:"small",select:!0,fullWidth:!0,value:null!==(u=null===(d=e.pivot)||void 0===d?void 0:d.rows)&&void 0!==u?u:"",onChange:function(t){console.log("handleSelectRows "+t.target.value);var a=e.groupBy.map((function(e){return L(e)})).filter((function(e){return!!e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectRows item "+(null===a||void 0===a?void 0:a.name));var r=t.target.value&&""!==t.target.value?t.target.value:void 0,l=Object(n.a)({},e.pivot,{rows:r});e.onPivotTableChange(l)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),R.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"columns-outlined-text",label:""!==Y?"Columns Field / "+Y:"Columns Field",size:"small",select:!0,fullWidth:!0,value:null!==(p=null===(m=e.pivot)||void 0===m?void 0:m.columns)&&void 0!==p?p:"",onChange:function(t){console.log("handleSelectColumns "+t.target.value);var a=e.groupBy.map((function(e){return L(e)})).filter((function(e){return!!e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectColumns item "+(null===a||void 0===a?void 0:a.name));var r=t.target.value&&""!==t.target.value?t.target.value:void 0,l=Object(n.a)({},e.pivot,{columns:r});e.onPivotTableChange(l)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),_.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"values-outlined-text",label:""!==X?"Values Field / "+X:"Values Field",size:"small",select:!0,fullWidth:!0,value:null!==(v=null===(h=e.pivot)||void 0===h?void 0:h.values)&&void 0!==v?v:"",onChange:function(t){var a;console.log("handleSelectValues "+t.target.value);var r=e.groupBy.map((function(e){return L(e)})).filter((function(e){return!!e})).map((function(e){return e})).find((function(e){return e.name===t.target.value}));console.log("handleSelectValues item "+(null===r||void 0===r?void 0:r.name));var l=t.target.value&&""!==t.target.value?t.target.value:void 0,i="number"!==(null===r||void 0===r?void 0:r.descriptor.type)?"count":null===(a=e.pivot)||void 0===a?void 0:a.op,o=Object(n.a)({},e.pivot,{values:l,op:i});e.onPivotTableChange(o)},variant:"outlined"},l.createElement(P.a,{key:"[no value]",value:""},"[ No value ]"),q.map((function(e){return l.createElement(P.a,{key:e.name,value:e.name},e.translation)})))),l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"values-op-outlined-text",label:"Value op",size:"small",select:!0,fullWidth:!0,value:null===(f=e.pivot)||void 0===f?void 0:f.op,onChange:function(t){console.log("handleSelectValuesOp "+t.target.value);var a=Object(n.a)({},e.pivot,{op:t.target.value});e.onPivotTableChange(a)},variant:"outlined"},K.map((function(e){return l.createElement(P.a,{key:e,value:e},e)})))),l.createElement(b.a,{item:!0},l.createElement(H.a,{control:l.createElement(Q.a,{checked:null!==(y=null===(E=e.pivot)||void 0===E?void 0:E.fixed1)&&void 0!==y&&y,onChange:function(t){console.log("handleFixed1 "+t.target.value);var a=t.target.checked,r=Object(n.a)({},e.pivot,{fixed1:a});e.onPivotTableChange(r)},size:"small"}),label:"Fixed 1 column"})),l.createElement(b.a,{item:!0},l.createElement(b.a,{container:!0,spacing:2,direction:"row",alignItems:"center",justify:"flex-start"},l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(H.a,{control:l.createElement(Q.a,{checked:null!==(C=null===(O=e.pivot)||void 0===O?void 0:O.delta)&&void 0!==C&&C,onChange:function(t){console.log("handleFixed1 "+t.target.value);var a=t.target.checked,r=Object(n.a)({},e.pivot,{delta:a});e.onPivotTableChange(r)},size:"small"}),label:"Delta column"})),null!==(S=null===(w=e.pivot)||void 0===w?void 0:w.delta)&&void 0!==S&&S?l.createElement(b.a,{item:!0},l.createElement(g.a,{id:"delta-title-outlined-text",label:"Title",size:"small",fullWidth:!0,defaultValue:"\u0394",value:null===(A=e.pivot)||void 0===A?void 0:A.deltaTitle,onChange:function(t){console.log("handleDeltaColumnTitle "+t.target.value);var a=Object(n.a)({},e.pivot,{deltaTitle:t.target.value});e.onPivotTableChange(a)},variant:"outlined"})):null,null!==(B=null===(x=e.pivot)||void 0===x?void 0:x.delta)&&void 0!==B&&B?l.createElement(b.a,{item:!0},l.createElement(H.a,{control:l.createElement(ie.a,{checked:null!==(F=null===(j=e.pivot)||void 0===j?void 0:j.deltaOnly)&&void 0!==F&&F,onChange:function(t){console.log("handleFixed1 "+t.target.value);var a=t.target.checked,r=Object(n.a)({},e.pivot,{deltaOnly:a});e.onPivotTableChange(r)},name:"deltaOnly"}),label:"Hide others"})):null)),null!==(D=null===(T=e.pivot)||void 0===T?void 0:T.delta)&&void 0!==D&&D?l.createElement(b.a,{item:!0},l.createElement(b.a,{container:!0,spacing:2,direction:"row",alignItems:"center",justify:"flex-start"},l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(g.a,{id:"values-op-outlined-text",label:"A",size:"small",select:!0,fullWidth:!0,value:null===(I=e.pivot)||void 0===I?void 0:I.deltaA,onChange:function(t){console.log("handleSelectDeltaA "+t.target.value);var a=t.target.value&&""!==t.target.value?t.target.value:void 0,r=Object(n.a)({},e.pivot,{deltaA:a});e.onPivotTableChange(r)},variant:"outlined"},te.map((function(e){return l.createElement(P.a,{key:e.key,value:e.value},e.value)})))),l.createElement(b.a,{item:!0,justify:"center",alignItems:"center"},l.createElement(se.a,null)),l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(g.a,{id:"values-op-outlined-text",label:"B",size:"small",select:!0,fullWidth:!0,value:null===(W=e.pivot)||void 0===W?void 0:W.deltaB,onChange:function(t){console.log("handleSelectDeltaB "+t.target.value);var a=t.target.value&&""!==t.target.value?t.target.value:void 0,r=Object(n.a)({},e.pivot,{deltaB:a});e.onPivotTableChange(r)},variant:"outlined"},ae.map((function(e){return l.createElement(P.a,{key:e.key,value:e.value},e.value)})))))):null,l.createElement(b.a,{item:!0},l.createElement(H.a,{control:l.createElement(Q.a,{checked:re,onChange:function(t){var a,r;console.log("handleWithReferenceValue "+t.target.value);var l=t.target.checked,i=Object(n.a)({},e.pivot,{referenceValue:l?0:void 0,referenceOp:l?null!==(a=null===(r=e.pivot)||void 0===r?void 0:r.referenceOp)&&void 0!==a?a:"eq":void 0});e.onPivotTableChange(i)},size:"small"}),label:"Highlight row if"})),re?l.createElement(b.a,{item:!0},l.createElement(b.a,{container:!0,spacing:2,direction:"row",alignItems:"stretch"},l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(g.a,{id:"reference-outlined-column",label:"Column",size:"small",select:!0,fullWidth:!0,value:null!==(N=null===(V=e.pivot)||void 0===V?void 0:V.referenceColumn)&&void 0!==N?N:"*",onChange:function(t){console.log("handleReferenceColumn "+t.target.value);var a=Object(n.a)({},e.pivot,{referenceColumn:t.target.value});e.onPivotTableChange(a)},variant:"outlined"},ne.map((function(e){return l.createElement(P.a,{key:e.key,value:e.value},e.value)})))),l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(g.a,{id:"op-value-textfield",label:"compare operation",size:"small",select:!0,fullWidth:!0,value:null===(z=e.pivot)||void 0===z?void 0:z.referenceOp,onChange:function(t){console.log("handleReferenceOp "+t.target.value);var a=Object(n.a)({},e.pivot,{referenceOp:t.target.value});e.onPivotTableChange(a)},variant:"outlined"},[{value:"gt",label:">"},{value:"lt",label:"<"},{value:"gte",label:">="},{value:"lte",label:"<="},{value:"eq",label:"=="},{value:"neq",label:"!="}].map((function(e,t){return l.createElement(P.a,{key:e.value,value:e.value},e.label)})))),l.createElement(b.a,{item:!0,xs:3,sm:3},l.createElement(g.a,{id:"reference-outlined-number",label:"Reference",size:"small",fullWidth:!0,value:null===(M=e.pivot)||void 0===M?void 0:M.referenceValue,onChange:function(t){console.log("handleReferenceValue "+t.target.value);var a=Object(n.a)({},e.pivot,{referenceValue:Number(t.target.value)});e.onPivotTableChange(a)},type:"number",InputLabelProps:{shrink:!0},variant:"outlined"})))):null))},ue=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return l.createElement("div",{title:"VisualizeTypeTable"},l.createElement(k.a,{variant:"h6"},"Events support is ugly on server. Can't select fields. Response with strange names not found in field list. To be fixed in future."),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),l.createElement(k.a,{variant:"subtitle2"},"TODO: add limit option"))}}]),t}(l.Component);var de=function(e){var t;return l.createElement("div",{title:"VisualizeTypePivotTable"},l.createElement(k.a,{variant:"h6"},"Markdown"),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),l.createElement(b.a,{container:!0,spacing:2,direction:"column",alignItems:"stretch"},l.createElement(b.a,{item:!0},l.createElement(H.a,{control:l.createElement(Q.a,{checked:null!==(t=e.bottom)&&void 0!==t&&t,onChange:function(t){console.log("handleMarkdownBottomChange "+t.target.value);var a=t.target.checked;e.onMarkdownBottomChange(a)},size:"small"}),label:"at bottom"}))))},pe=function(e){function t(){return Object(d.a)(this,t),Object(m.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return l.createElement(y.a,{variant:"elevation",elevation:0,title:"Choose the way in which the result dataset or some static information will be presented"},l.createElement(k.a,{variant:"h5"},"Visualize"),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),l.createElement(X,{value:this.props.visualizeType,onChange:this.props.onChange}),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),"Chart"===this.props.visualizeType?l.createElement(K,{chart:this.props.chart,groupBy:this.props.groupBy,groupByAvailable:this.props.groupByAvailable,onChartChange:this.props.onChartChange}):null,"Pie"===this.props.visualizeType?l.createElement(Z,{chart:this.props.chart,groupBy:this.props.groupBy,groupByAvailable:this.props.groupByAvailable,onChartChange:this.props.onChartChange}):null,"Counter"===this.props.visualizeType?l.createElement(ee,{counter:this.props.counter,groupBy:this.props.groupBy,groupByAvailable:this.props.groupByAvailable,onCounterChange:this.props.onCounterChange}):null,"Table"===this.props.visualizeType?l.createElement(le,{table:this.props.table,groupBy:this.props.groupBy,groupByAvailable:this.props.groupByAvailable,onTableChange:this.props.onTableChange}):null,"PivotTable"===this.props.visualizeType?l.createElement(ce,{pivot:this.props.pivot,groupBy:this.props.groupBy,groupByAvailable:this.props.groupByAvailable,possibleValues:this.props.possibleValues,onPivotTableChange:this.props.onPivotTableChange}):null,"Events"===this.props.visualizeType?l.createElement(ue,null):null,"Markdown"===this.props.visualizeType?l.createElement(de,{bottom:this.props.bottom,onMarkdownBottomChange:this.props.onMarkdownBottomChange}):null,l.createElement(k.a,{variant:"subtitle2"},"\xa0"))}}]),t}(l.Component),me=a(29),ve=a.n(me),he=a(846),fe=a(847),ge=a(848),ye=a(849),be=a(449),Ee=a(189),Ce=a.n(Ee),ke=a(125),Oe=a.n(ke),Se=a(161),we=a.n(Se),Ae=a(188),Be=a.n(Ae),xe=a(490),Fe=a(718),je=a.n(Fe),De=a(447),Te=a.n(De),Ie=a(448),Pe=a.n(Ie);Te.a.vfs=Pe.a.pdfMake.vfs;var We=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).state={rows:void 0,err:void 0,openFullscreen:!1},a.lineChart=null,a.barChart=null,a.areaChart=null,a.handleFullscreenOpen=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!0})}))},a.handleFullscreenClose=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!1})}))},a.handleEdit=function(){console.log("handleEdit "+a.props.id),a.props.onEditWidget&&a.props.onEditWidget(a.props.id)},a.handleDelete=function(){console.log("handleDelete "+a.props.id),a.props.onDeleteWidget&&a.props.onDeleteWidget(a.props.id)},a.stringToColour=function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);for(var n="#",r=0;r<3;r++){n+=("00"+(t>>8*r&255).toString(16)).substr(-2)}return n},a.download=function(){var e=document.getElementById("download"),t=document.getElementById("myCanvas").toDataURL("image/png").replace("image/png","image/octet-stream");e.setAttribute("href",t)},a.exportChart=function(e){var t,n,r=null!==(t=null!==(n=a.lineChart)&&void 0!==n?n:a.barChart)&&void 0!==t?t:a.areaChart;if(r){var l=ve.a.findDOMNode(r).children[0];if(e){var i,o,s=(new XMLSerializer).serializeToString(l),c=(new Blob([s],{type:"image/svg+xml;charset=utf-8"}),i=l.getAttribute("width"),o=l.getAttribute("height"),{footer:function(e,t){return{text:"Created at "+new Date,alignment:"center"}},content:[a.props.title,"\n",a.props.description,"\n","something more can be added",{svg:s,width:500}]});Te.a.createPdf(c).download(a.props.title+".pdf")}else{var u=new Blob([l.outerHTML],{type:"text/html;charset=utf-8"});je.a.saveAs(u,a.props.title+".html")}}},a.svgToPng=function(e,t,a){return new Promise((function(n,r){var l=document.createElement("canvas");l.width=t,l.height=a;var i=l.getContext("2d");i.fillStyle="#ffffff",i.fillRect(0,0,t,a);var o=(new XMLSerializer).serializeToString(e),s="data:image/svg+xml;utf8,"+encodeURIComponent(o),c=new Image(t,a);c.onload=function(){i.drawImage(c,0,0);var e=l.toDataURL("image/png",1);n(e)},c.onerror=function(){return r()},c.src=s}))},a.handleDownloadSvg=function(){var e,t,n=null!==(e=null!==(t=a.lineChart)&&void 0!==t?t:a.barChart)&&void 0!==e?e:a.areaChart;if(n){var r=ve.a.findDOMNode(n).children[0],l=(new XMLSerializer).serializeToString(r),i=new Blob([l],{type:"image/svg+xml;charset=utf-8"});je.a.saveAs(i,a.props.title+".svg")}},a.handleDownloadPng=Object(x.a)(B.a.mark((function e(){var t,n,r,l,i,o,s,c,u,d;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=null!==(t=null!==(n=a.lineChart)&&void 0!==n?n:a.barChart)&&void 0!==t?t:a.areaChart)){e.next=14;break}return o=ve.a.findDOMNode(r).children[0],s=null!==(l=o.getAttribute("width"))&&void 0!==l?l:"1920",c=null!==(i=o.getAttribute("height"))&&void 0!==i?i:"1080",e.next=7,a.svgToPng(o,Number(s),Number(c));case 7:u=e.sent,u.replace("image/png","image/octet-stream"),new Blob([u],{type:"image/png"}),(d=document.createElement("a")).href=u,d.download=a.props.title+".png",d.click();case 14:case"end":return e.stop()}}),e)}))),a.handleDownloadPdf=function(){a.exportChart(!0)},a.handleDownload=function(){a.exportChart(!0)},a.handleDownload1=Object(x.a)(B.a.mark((function e(){var t,n,r,l,i,o;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=null!==(t=null!==(n=a.lineChart)&&void 0!==n?n:a.barChart)&&void 0!==t?t:a.areaChart)){e.next=9;break}return l=ve.a.findDOMNode(r).children[0],e.next=5,a.svgToPng(l,900,500);case 5:i=e.sent,o=i.replace("image/png","image/octet-stream"),document.getElementById("download").setAttribute("href",o);case 9:case"end":return e.stop()}}),e)}))),a.handleDownload111=Object(x.a)(B.a.mark((function e(){var t,n,r,l,i,o;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=null!==(t=null!==(n=a.lineChart)&&void 0!==n?n:a.barChart)&&void 0!==t?t:a.areaChart)){e.next=8;break}return l=ve.a.findDOMNode(r).children[0],e.next=5,a.svgToPng(l,546,300);case 5:i=e.sent,o={content:["SVG nodes behave similar to images by supporting width/height or fit","It is however not yet possible to use svg files or to have a library of svgs in the document definition","\n","Note that before you can use SVG nodes you must install svg-to-pdfkit as it is not included with pdfmake to keep bundle size down",{image:i,width:546,height:300}]},Te.a.createPdf(o).download("chart.pdf");case 8:case"end":return e.stop()}}),e)}))),a.loadData=function(){console.log("WidgetPreviewChart loadData"),a.setState({rows:void 0,err:void 0});var e=a.props.api+"/api/v2/ad-query/aggregation/table",t=a.props.chartState,n=t.x,r=t.y,l=t.op,i=t.series,o={filter:{keys:a.props.filterItems.filter((function(e){return"set"===e.type||"dictionary"===e.type})).map((function(e){return{field:e.field,op:e.op,value:e.value}})),numbers:a.props.filterItems.filter((function(e){return"number"===e.type})).map((function(e){return{field:e.field,op:e.op,value:Number.parseFloat(e.value)}})),lists:[],period:a.props.period},groupBy:[n,r,i],fields:[{field:r,op:l}]},s={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.props.token},body:JSON.stringify(o)};fetch(e,s).then((function(e){return e.json()})).then((function(e){if(null==e.result)throw Error("no rows in result"+JSON.stringify(e));var t=e.result;console.log("WidgetPreviewLineChart r="+JSON.stringify(t)),a.setState({rows:t}),console.log("WidgetPreviewLineChart data="+JSON.stringify(e))})).catch((function(e){a.setState({err:e.message})}))},a.handleClick=function(e,t){e&&console.log("onClick "+a.props.title+" index="+t+" data[index]="+JSON.stringify(e.payload))},a.handleClickLine=function(e,t){e&&console.log("onClick "+a.props.title+" activeLabel="+e.activeLabel)},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){console.log("WidgetPreviewChart componentDidMount "+JSON.stringify(this.props.chartState)),this.loadData()}},{key:"componentDidUpdate",value:function(e){console.log("WidgetPreviewChart componentDidUpdate "+JSON.stringify(this.props.chartState)),JSON.stringify(this.props)!==JSON.stringify(e)&&this.loadData()}},{key:"render",value:function(){var e=this;if(this.state.err)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: ",this.state.err)));if(!this.props.chartState)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: no chartState")));var t=this.props.chartState,a=t.type,n=t.x,r=t.y,i=t.op,s=t.series;if(!a)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: no type")));if(!n||!r||!i||!s)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: chartState content ",JSON.stringify(this.props.chartState))));if(!this.state.rows)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: no rows")));var c,u=this.state.rows,d=this.props.groupByAvailable.filter((function(t){return t.name===e.props.chartState.series})),p=this.props.chartState.series,m=d[0].descriptor.type,v=[];"set"===m?v=(null===(c=this.props.possibleValues.set.get(p))||void 0===c?void 0:c.map((function(e){return{key:e,value:e}})))||[]:"dictionary"===m&&(v=this.props.possibleValues.dictionary.get(p)||[]);console.log(v);var h=u.reduce((function(e,t){var a=t[s];return e.add(a),e}),new Set);v=v.filter((function(e){return h.has(e.key)}));var f=u.reduce((function(e,t){var a=t[n],l=e.get(a)||{x:a};return l[t[s]]=t[i+"_"+r],e.set(a,l),e}),new Map);console.log(f);var g=o.a(f.values()).sortBy((function(e){return e.x}));console.log(g.toArray());var y=g.toArray(),b=l.createElement(k.a,null,"Error: unknown type ",a);return"Line"===a&&(b=l.createElement(xe.j,{ref:function(t){return e.lineChart=t},width:400,height:300,data:y,margin:{top:5,right:20,left:10,bottom:5},onClick:this.handleClickLine},l.createElement(xe.o,{dataKey:"x"}),l.createElement(xe.p,null),l.createElement(xe.n,null),l.createElement(xe.h,null),l.createElement(xe.f,{stroke:"#f5f5f5",strokeDasharray:"5 5"}),v.map((function(t){return l.createElement(xe.i,{type:"monotone",connectNulls:!0,stroke:e.stringToColour(t.key),isAnimationActive:!1,dataKey:t.key,name:t.value,activeDot:{onClick:function(e){return console.log("activeDot: ",e)}}})})),this.props.chartState.brush?l.createElement(xe.e,null):null)),"Bar"===a&&(b=l.createElement(xe.d,{ref:function(t){return e.barChart=t},width:400,height:300,data:y,margin:{top:5,right:20,left:10,bottom:5},onClick:this.handleClickLine},l.createElement(xe.o,{dataKey:"x"}),l.createElement(xe.p,null),l.createElement(xe.n,null),l.createElement(xe.h,null),l.createElement(xe.f,{stroke:"#f5f5f5",strokeDasharray:"5 5"}),v.map((function(t){return l.createElement(xe.c,{stroke:e.stringToColour(t.key),fill:e.stringToColour(t.key),dataKey:t.key,name:t.value,onClick:e.handleClick})})),this.props.chartState.brush?l.createElement(xe.e,null):null)),"Area"===a&&(b=l.createElement(xe.b,{ref:function(t){return e.areaChart=t},width:400,height:300,data:y,margin:{top:5,right:20,left:10,bottom:5},onClick:this.handleClickLine},l.createElement(xe.o,{dataKey:"x"}),l.createElement(xe.p,null),l.createElement(xe.n,null),l.createElement(xe.h,null),l.createElement(xe.f,{stroke:"#f5f5f5",strokeDasharray:"5 5"}),v.map((function(t){return l.createElement(xe.a,{type:"monotone",connectNulls:!0,stroke:e.stringToColour(t.key),fill:e.stringToColour(t.key),fillOpacity:.5,dataKey:t.key,name:t.value})})),this.props.chartState.brush?l.createElement(xe.e,null):null)),l.createElement("div",{id:this.props.id},l.createElement(he.a,{variant:"outlined"},l.createElement(ge.a,{action:l.createElement(T.a,{"aria-label":"fullscreen",onClick:this.handleFullscreenOpen},l.createElement(Be.a,null)),title:this.props.title,subheader:this.props.description}),l.createElement(fe.a,null,l.createElement(xe.m,{width:"95%",height:300},b)),this.props.isEditMode?l.createElement(ye.a,{disableSpacing:!0},l.createElement(T.a,{"aria-label":"edit",onClick:this.handleEdit},l.createElement(Oe.a,null)),l.createElement(T.a,{"aria-label":"delete",onClick:this.handleDelete},l.createElement(we.a,null))):null),l.createElement(q.a,{fullScreen:!0,open:this.state.openFullscreen,onClose:this.handleFullscreenClose},l.createElement(L.a,{id:"editor-dialog-title"},l.createElement(be.a,{variant:"dense"},l.createElement(T.a,{edge:"start",color:"inherit",onClick:this.handleFullscreenClose,"aria-label":"close"},l.createElement(Ce.a,null)),l.createElement(k.a,{variant:"h6"},this.props.title),l.createElement(z.a,{color:"inherit",onClick:this.handleDownloadPdf},"PDF"),l.createElement(z.a,{color:"inherit",onClick:this.handleDownloadSvg},"SVG"),l.createElement(z.a,{color:"inherit",onClick:this.handleDownloadPng},"PNG"))),l.createElement(R.a,null,l.createElement(k.a,{variant:"h6"},this.props.description),l.createElement(xe.m,{width:"95%",height:700},b))))}}]),t}(l.Component),Ne=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={rows:void 0,err:void 0},a.handleEdit=function(){console.log("handleEdit "+a.props.id),a.props.onEditWidget&&a.props.onEditWidget(a.props.id)},a.handleDelete=function(){console.log("handleDelete "+a.props.id),a.props.onDeleteWidget&&a.props.onDeleteWidget(a.props.id)},a.loadData=function(){console.log("WidgetPreviewPie loadData"),a.setState({rows:void 0,err:void 0});var e=a.props.api+"/api/v2/ad-query/aggregation/table",t=a.props.chartState,n=t.x,r=t.y,l=t.op,i=t.series,o={filter:{keys:a.props.filterItems.filter((function(e){return"set"===e.type||"dictionary"===e.type})).map((function(e){return{field:e.field,op:e.op,value:e.value}})),numbers:a.props.filterItems.filter((function(e){return"number"===e.type})).map((function(e){return{field:e.field,op:e.op,value:Number.parseFloat(e.value)}})),lists:[],period:a.props.period},groupBy:[n,r,i],fields:[{field:r,op:l}]},s={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.props.token},body:JSON.stringify(o)};fetch(e,s).then((function(e){return e.json()})).then((function(e){if(null==e.result)throw Error("no rows in result"+JSON.stringify(e));var t=e.result;console.log("WidgetPreviewLineChart r="+JSON.stringify(t)),a.setState({rows:t}),console.log("WidgetPreviewLineChart data="+JSON.stringify(e))})).catch((function(e){a.setState({err:e.message})}))},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){console.log("WidgetPreviewPie componentDidMount "+JSON.stringify(this.props.chartState)),this.loadData()}},{key:"componentDidUpdate",value:function(e){console.log("WidgetPreviewPie componentDidUpdate "+JSON.stringify(this.props.chartState)),JSON.stringify(this.props)!==JSON.stringify(e)&&this.loadData()}},{key:"render",value:function(){var e=this;if(this.state.err)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: ",this.state.err)));if(!this.props.chartState)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: no chartState")));var t=this.props.chartState,a=t.x,n=t.y,r=t.op,i=t.series;if(!a||!n||!r||!i)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: chartState content ",JSON.stringify(this.props.chartState))));if(!this.state.rows)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"Error: no rows")));var s,c=this.state.rows,u=this.props.groupByAvailable.filter((function(t){return t.name===e.props.chartState.series})),d=this.props.chartState.series,p=u[0].descriptor.type,m=[];"set"===p?m=(null===(s=this.props.possibleValues.set.get(d))||void 0===s?void 0:s.map((function(e){return{key:e,value:e}})))||[]:"dictionary"===p&&(m=this.props.possibleValues.dictionary.get(d)||[]);console.log(m);var v=c.reduce((function(e,t){var a=t[i];return e.add(a),e}),new Set);m=m.filter((function(e){return v.has(e.key)}));var h=c.reduce((function(e,t){var l=t[i]+"("+t[a]+")",o=e.get(l)||{x:l};return o.value=t[r+"_"+n],e.set(l,o),e}),new Map);console.log(h);var f=o.a(h.keys()).sortBy((function(e){return e.x})),g=o.a(h.values()).sortBy((function(e){return e.x}));console.log(f.toArray()),console.log(g.toArray());var y=g.toArray(),b=function(e){for(var t=0,a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);for(var n="#",r=0;r<3;r++){n+=("00"+(t>>8*r&255).toString(16)).substr(-2)}return n};return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,{align:"center",color:"textSecondary",gutterBottom:!0},this.props.title),l.createElement(xe.m,{width:"95%",height:400},l.createElement(xe.l,{width:400,height:400,margin:{top:5,right:20,left:10,bottom:5}},l.createElement(xe.n,null),l.createElement(xe.h,null),l.createElement(xe.k,{cx:"50%",cy:"50%",data:y,label:!0,innerRadius:80,outerRadius:100,dataKey:"value",nameKey:"x",key:"value"},y.map((function(e,t){return l.createElement(xe.g,{key:"cell-".concat(t),fill:b(e.x)})}))))),l.createElement(k.a,{align:"center",color:"textSecondary"},this.props.description)),this.props.isEditMode?l.createElement(ye.a,{disableSpacing:!0},l.createElement(T.a,{"aria-label":"edit",onClick:this.handleEdit},l.createElement(Oe.a,null)),l.createElement(T.a,{"aria-label":"delete",onClick:this.handleDelete},l.createElement(we.a,null))):null)}}]),t}(l.Component),Ve=a(301),ze=a.n(Ve),Me=a(310),Je=a.n(Me),Le=a(321),Re=a.n(Le),_e=a(311),qe=a.n(_e),Ue=a(319),Ge=a.n(Ue),Ye=a(314),Xe=a.n(Ye),He=a(312),Qe=a.n(He),Ke=a(313),Ze=a.n(Ke),$e=a(316),et=a.n($e),tt=a(317),at=a.n(tt),nt=a(318),rt=a.n(nt),lt=a(315),it=a.n(lt),ot=a(320),st=a.n(ot),ct=a(322),ut=a.n(ct),dt=a(247),pt=a.n(dt),mt=function(e){return Object(l.forwardRef)((function(t,a){return i.a.createElement(e,Object.assign({},t,{ref:a}))}))},vt={Add:mt(Je.a),Check:mt(qe.a),Clear:mt(Qe.a),Delete:mt(Ze.a),DetailPanel:mt(Xe.a),Edit:mt(Oe.a),Export:mt(it.a),Filter:mt(et.a),FirstPage:mt(at.a),LastPage:mt(rt.a),NextPage:mt(Xe.a),PreviousPage:mt(Ge.a),ResetSearch:mt(Qe.a),Search:mt(st.a),SortArrow:mt(Re.a),ThirdStateCheck:mt(se.a),ViewColumn:mt(ut.a)},ht=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).state={rows:void 0,err:void 0,openFullscreen:!1,selected:void 0},a.handleFullscreenOpen=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!0})}))},a.handleFullscreenClose=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!1})}))},a.handleEdit=function(){console.log("handleEdit "+a.props.id),a.props.onEditWidget&&a.props.onEditWidget(a.props.id)},a.handleDelete=function(){console.log("handleDelete "+a.props.id),a.props.onDeleteWidget&&a.props.onDeleteWidget(a.props.id)},a.loadData=function(){var e,t,n,r,l;console.log("WidgetAggregationTable loadData"),a.setState({rows:void 0,err:void 0});var i=a.props.api+"/api/v2/ad-query/aggregation/table",s=o.a(a.props.groupBy).map((function(e){return t=e,a.props.groupByAvailable.find((function(e){return e.name===t}));var t})).filter((function(e){return!!e})).map((function(e){return e})),c=null!==(e=null!==(t=a.props.tableState.field)&&void 0!==t?t:o.a(a.props.groupBy).first())&&void 0!==e?e:"",u=null!==(n=s.filter((function(e){return e.name===c})).map((function(e){return e.descriptor.type})).first())&&void 0!==n?n:"",d=a.props.tableState.isAggregationFieldInGroupBy?o.a(a.props.groupBy).toArray():o.a(a.props.groupBy).filter((function(e){return e!==c})).toArray(),p=("number"!==u?["count"]:["count","avg","sum","min","max"]).includes(null!==(r=a.props.tableState.op)&&void 0!==r?r:"")&&null!==(l=a.props.tableState.op)&&void 0!==l?l:"count",m={filter:{keys:a.props.filterItems.filter((function(e){return"set"===e.type||"dictionary"===e.type})),numbers:a.props.filterItems.filter((function(e){return"number"===e.type})).map((function(e){return{field:e.field,op:e.op,value:Number.parseFloat(e.value)}})),lists:[],period:a.props.period},groupBy:d,fields:[{field:c,op:p}]},v={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.props.token},body:JSON.stringify(m)};fetch(i,v).then((function(e){return e.json()})).then((function(e){if(null==e.result)throw Error("no rows in result"+JSON.stringify(e));var t=e.result.map((function(e){return e}));a.setState({rows:t}),console.log("WidgetAggregationTable data="+JSON.stringify(e))})).catch((function(e){a.setState({err:e.message})}))},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){console.log("WidgetAggregationTable componentDidMount "+this.props.tableState.field),this.loadData()}},{key:"componentDidUpdate",value:function(e){console.log("WidgetAggregationTable componentDidUpdate "+this.props.tableState.field),JSON.stringify(this.props)!==JSON.stringify(e)&&this.loadData()}},{key:"render",value:function(){var e,t,a,n,r,l,s=this,c=o.a(this.props.groupBy).map((function(e){return t=e,s.props.groupByAvailable.find((function(e){return e.name===t}));var t})).filter((function(e){return!!e})).map((function(e){return e})),u=null!==(e=null!==(t=this.props.tableState.field)&&void 0!==t?t:o.a(this.props.groupBy).first())&&void 0!==e?e:"",d=null!==(a=c.filter((function(e){return e.name===u})).map((function(e){return e.descriptor.type})).first())&&void 0!==a?a:"",p=null!==(n=c.filter((function(e){return e.name===u})).map((function(e){return e.translation})).first())&&void 0!==n?n:u,m=("number"!==d?["count"]:["count","avg","sum","min","max"]).includes(null!==(r=this.props.tableState.op)&&void 0!==r?r:"")&&null!==(l=this.props.tableState.op)&&void 0!==l?l:"count",v=c.filter((function(e){return!!s.props.tableState.isAggregationFieldInGroupBy||e.name!==u})).map((function(e){var t=[];"dictionary"===e.descriptor.type&&(t=(t=s.props.possibleValues.dictionary.get(e.name)||[]).map((function(e){return{key:e.key,value:e.value&&""!==e.value?e.value:e.key}})));var a=t.reduce((function(e,t){var a=t.key,n=t.value;return e.set(a,n),e}),new Map),n=Object.fromEntries(a.entries());return console.log(n),{field:e.name,title:e.translation,lookup:"dictionary"===e.descriptor.type?n:void 0}})),h={field:m+"_"+u,title:m+"("+p+")"},f=v.toArray().concat(h);if(this.state.err)return i.a.createElement(he.a,{variant:"outlined"},i.a.createElement(fe.a,null,i.a.createElement(k.a,null,"Error: ",this.state.err)));var g=i.a.createElement(ze.a,{icons:vt,columns:f,onColumnDragged:function(e,t){console.log("Dropped column from "+e+" to position "+t)},options:{showTitle:!1,padding:"dense",exportAllData:!0,exportButton:!0,exportFileName:this.props.title+"."+pt()().format("YYYYMMDDTHHmmss"),rowStyle:function(e){return{backgroundColor:s.state.selected===e.tableData.id?"#EEE":"#FFF"}}},onRowClick:function(e,t){return s.setState({selected:null===t||void 0===t?void 0:t.tableData.id})},title:this.props.title,isLoading:!this.state.rows&&!this.state.err,data:this.state.rows,components:{Container:function(e){return i.a.createElement(y.a,Object.assign({},e,{elevation:0}))}}});return i.a.createElement("div",{id:this.props.id},i.a.createElement(he.a,{variant:"outlined",title:this.props.title},i.a.createElement(ge.a,{action:i.a.createElement(T.a,{"aria-label":"fullscreen",onClick:this.handleFullscreenOpen},i.a.createElement(Be.a,null)),title:this.props.title,subheader:this.props.description}),i.a.createElement(fe.a,null,g),this.props.isEditMode?i.a.createElement(ye.a,{disableSpacing:!0},i.a.createElement(T.a,{"aria-label":"edit",onClick:this.handleEdit},i.a.createElement(Oe.a,null)),i.a.createElement(T.a,{"aria-label":"delete",onClick:this.handleDelete},i.a.createElement(we.a,null))):null),i.a.createElement(q.a,{fullScreen:!0,open:this.state.openFullscreen,onClose:this.handleFullscreenClose},i.a.createElement(L.a,{id:"editor-dialog-title"},i.a.createElement(be.a,{variant:"dense"},i.a.createElement(T.a,{edge:"start",color:"inherit",onClick:this.handleFullscreenClose,"aria-label":"close"},i.a.createElement(Ce.a,null)),i.a.createElement(k.a,{variant:"h6"},this.props.title))),i.a.createElement(R.a,null,i.a.createElement(k.a,{variant:"h6"},this.props.description),g)))}}]),t}(i.a.Component),ft=a(814),gt=a.n(ft),yt=function(e){return Object(l.forwardRef)((function(t,a){return i.a.createElement(e,Object.assign({},t,{ref:a}))}))},bt={Add:yt(Je.a),Check:yt(qe.a),Clear:yt(Qe.a),Delete:yt(Ze.a),DetailPanel:yt(Xe.a),Edit:yt(Oe.a),Export:yt(it.a),Filter:yt(et.a),FirstPage:yt(at.a),LastPage:yt(rt.a),NextPage:yt(Xe.a),PreviousPage:yt(Ge.a),ResetSearch:yt(Qe.a),Search:yt(st.a),SortArrow:yt(Re.a),ThirdStateCheck:yt(se.a),ViewColumn:yt(ut.a)},Et=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).state={rows:void 0,err:void 0,openEventFullscreen:!1,openFullscreen:!1,selected:void 0},a.itemByName=function(e){return a.props.groupByAvailable.find((function(t){return t.name===e}))},a.handleEventFullscreenOpen=function(){a.setState((function(e){return Object(n.a)({},e,{openEventFullscreen:!0})}))},a.handleEventFullscreenClose=function(){a.setState((function(e){return Object(n.a)({},e,{openEventFullscreen:!1})}))},a.handleFullscreenOpen=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!0})}))},a.handleFullscreenClose=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!1})}))},a.handleEdit=function(){console.log("handleEdit "+a.props.id),a.props.onEditWidget&&a.props.onEditWidget(a.props.id)},a.handleDelete=function(){console.log("handleDelete "+a.props.id),a.props.onDeleteWidget&&a.props.onDeleteWidget(a.props.id)},a.loadData=function(){console.log("WidgetEvents loadData"),a.setState({rows:void 0,err:void 0});var e=a.props.api+"/api/v2/ad-query/events",t={filter:{keys:a.props.filterItems.filter((function(e){return"set"===e.type||"dictionary"===e.type})),numbers:a.props.filterItems.filter((function(e){return"number"===e.type})).map((function(e){return{field:e.field,op:e.op,value:Number.parseFloat(e.value)}})),lists:[],period:a.props.period},limit:a.props.limit},n={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.props.token},body:JSON.stringify(t)};fetch(e,n).then((function(e){return e.json()})).then((function(e){if(null==e.events)throw Error("no events in result"+JSON.stringify(e));var t,n=null!==(t=e.events)&&void 0!==t?t:[];a.setState({rows:n}),console.log("WidgetEvents data="+JSON.stringify(e))})).catch((function(e){a.setState({err:e.message})}))},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){console.log("WidgetEvents componentDidMount "),this.loadData()}},{key:"componentDidUpdate",value:function(e){console.log("WidgetEvents componentDidUpdate "),JSON.stringify(this.props)!==JSON.stringify(e)&&this.loadData()}},{key:"render",value:function(){var e=this;if(this.state.err)return i.a.createElement(he.a,{variant:"outlined"},i.a.createElement(fe.a,null,i.a.createElement(k.a,null,"Error: ",this.state.err)));var t=[{field:"id",title:"id",hidden:!0},{field:"time_date",title:"date",type:"date"},{field:"time_time",title:"time",type:"time"},{field:"source_video_name",title:"video"},{field:"source_server_name",title:"server"},{field:"source_detector_name",title:"detector"},{field:"event_detector_type_name",title:"detector_type"},{field:"description",title:"description",headerStyle:{font:"bold"},render:function(t){var a;return console.log("description "+t.id+" "+JSON.stringify(t.description)),Object.entries(null!==(a=t.description)&&void 0!==a?a:{}).map((function(t){var a,n,l=Object(r.a)(t,2),i=l[0],o=l[1];return(null!==(a=null===(n=e.itemByName(i))||void 0===n?void 0:n.translation)&&void 0!==a?a:i)+" = "+o+"\n"}))}},{field:"raw",title:"raw",hidden:!0,headerStyle:{font:"bold"},render:function(e){return JSON.stringify(e)}}],a=i.a.createElement(ze.a,{icons:bt,columns:t,onColumnDragged:function(e,t){console.log("Dropped column from "+e+" to position "+t)},options:{selection:!0,toolbarButtonAlignment:"left",showTitle:!1,padding:"dense",exportAllData:!0,exportButton:!0,pageSize:5,pageSizeOptions:[5,10,20,50],draggable:this.props.isEditMode,exportFileName:this.props.title+"."+pt()().format("YYYYMMDDTHHmmss"),rowStyle:function(t){return{backgroundColor:e.state.selected===t.tableData.id?"#EEE":"#FFF"}}},actions:[{tooltip:"Tag",icon:function(){return i.a.createElement(gt.a,null)},onClick:function(e,t){var a=null===t||void 0===t?void 0:t.length;alert("You want to add tag to "+a+" rows. Not implemented in backend yet.")}}],onRowClick:function(t,a){e.setState({openEventFullscreen:!0,selectedEvent:a})},title:this.props.title,isLoading:!this.state.rows&&!this.state.err,data:this.state.rows,components:{Container:function(e){return i.a.createElement(y.a,Object.assign({},e,{elevation:0}))}}});return i.a.createElement("div",{id:this.props.id},i.a.createElement(he.a,{variant:"outlined",title:this.props.title},i.a.createElement(ge.a,{action:i.a.createElement(T.a,{"aria-label":"fullscreen",onClick:this.handleFullscreenOpen},i.a.createElement(Be.a,null)),title:this.props.title,subheader:this.props.description}),i.a.createElement(fe.a,null,a),this.props.isEditMode?i.a.createElement(ye.a,{disableSpacing:!0},i.a.createElement(T.a,{"aria-label":"edit",onClick:this.handleEdit},i.a.createElement(Oe.a,null)),i.a.createElement(T.a,{"aria-label":"delete",onClick:this.handleDelete},i.a.createElement(we.a,null))):null),i.a.createElement(q.a,{fullScreen:!0,open:this.state.openFullscreen,onClose:this.handleFullscreenClose},i.a.createElement(L.a,{id:"editor-dialog-title"},i.a.createElement(be.a,{variant:"dense"},i.a.createElement(T.a,{edge:"start",color:"inherit",onClick:this.handleFullscreenClose,"aria-label":"close"},i.a.createElement(Ce.a,null)),i.a.createElement(k.a,{variant:"h6"},this.props.title))),i.a.createElement(R.a,null,i.a.createElement(k.a,{variant:"h6"},this.props.description),a)),i.a.createElement(q.a,{fullScreen:!0,open:this.state.openEventFullscreen,onClose:this.handleEventFullscreenClose},i.a.createElement(L.a,{id:"event-dialog-title"},i.a.createElement(be.a,{variant:"dense"},i.a.createElement(T.a,{edge:"start",color:"inherit",onClick:this.handleEventFullscreenClose,"aria-label":"close"},i.a.createElement(Ce.a,null)),i.a.createElement(k.a,{variant:"h6"},"Event"))),i.a.createElement(R.a,null,i.a.createElement(k.a,{variant:"h6"},"TODO: show snapshot / video player"),i.a.createElement("pre",null,JSON.stringify(this.state.selectedEvent,void 0,2)))))}}]),t}(i.a.Component),Ct=function(e){return Object(l.forwardRef)((function(t,a){return i.a.createElement(e,Object.assign({},t,{ref:a}))}))},kt={Add:Ct(Je.a),Check:Ct(qe.a),Clear:Ct(Qe.a),Delete:Ct(Ze.a),DetailPanel:Ct(Xe.a),Edit:Ct(Oe.a),Export:Ct(it.a),Filter:Ct(et.a),FirstPage:Ct(at.a),LastPage:Ct(rt.a),NextPage:Ct(Xe.a),PreviousPage:Ct(Ge.a),ResetSearch:Ct(Qe.a),Search:Ct(st.a),SortArrow:Ct(Re.a),ThirdStateCheck:Ct(se.a),ViewColumn:Ct(ut.a)},Ot=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).state={rows:void 0,err:void 0,openFullscreen:!1,selected:void 0},a.handleFullscreenOpen=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!0})}))},a.handleFullscreenClose=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!1})}))},a.handleEdit=function(){console.log("handleEdit "+a.props.id),a.props.onEditWidget&&a.props.onEditWidget(a.props.id)},a.handleDelete=function(){console.log("handleDelete "+a.props.id),a.props.onDeleteWidget&&a.props.onDeleteWidget(a.props.id)},a.loadData=function(){console.log("WidgetPivotTable loadData"),a.setState({rows:void 0,err:void 0});var e=a.props.api+"/api/v2/ad-query/aggregation/table",t=a.props.tableState,n=t.rows,r=t.columns,l=t.values,i=t.op,o={filter:{keys:a.props.filterItems.filter((function(e){return"set"===e.type||"dictionary"===e.type})),numbers:a.props.filterItems.filter((function(e){return"number"===e.type})).map((function(e){return{field:e.field,op:e.op,value:Number.parseFloat(e.value)}})),lists:[],period:a.props.period},groupBy:[n,r,l],fields:[{field:l,op:i}]},s={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.props.token},body:JSON.stringify(o)};fetch(e,s).then((function(e){return e.json()})).then((function(e){if(null==e.result)throw Error("no rows in result"+JSON.stringify(e));var t=e.result.map((function(e){return e}));a.setState({rows:t}),console.log("WidgetPivotTable data="+JSON.stringify(e))})).catch((function(e){a.setState({err:e.message})}))},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){console.log("WidgetPivotTable componentDidMount "),this.loadData()}},{key:"componentDidUpdate",value:function(e){console.log("WidgetPivotTable componentDidUpdate "),JSON.stringify(this.props)!==JSON.stringify(e)&&this.loadData()}},{key:"render",value:function(){var e,t=this,a=this.props.tableState,n=a.rows,r=a.columns,l=a.values,s=a.op;if(!n||!r||!s||!l)return i.a.createElement(he.a,{variant:"outlined"},i.a.createElement(fe.a,null,i.a.createElement(k.a,null,"Error: state is not complete, content"," ",JSON.stringify(this.props.tableState))));if(this.state.err)return i.a.createElement(he.a,{variant:"outlined"},i.a.createElement(fe.a,null,i.a.createElement(k.a,null,"Error: ",this.state.err)));if(!this.state.rows)return i.a.createElement(he.a,{variant:"outlined"},i.a.createElement(fe.a,null,i.a.createElement(k.a,null,"No rows")));var c,u=this.state.rows,d=this.props.groupByAvailable.filter((function(e){return e.name===r})),p=r,m=d[0].descriptor.type,v=this.props.groupByAvailable.filter((function(e){return e.name===n})),h=n,f=v[0].descriptor.type,g=v[0].translation,b=[];"set"===m?b=(null===(c=this.props.possibleValues.set.get(p))||void 0===c?void 0:c.map((function(e){return{key:e,value:e}})))||[]:"dictionary"===m&&(b=(b=this.props.possibleValues.dictionary.get(p)||[]).map((function(e){return{key:e.key,value:e.value&&""!==e.value?e.value:e.key}})));console.log("columnsValues = "+JSON.stringify(b));var E,O=[];"set"===f?O=(null===(E=this.props.possibleValues.set.get(h))||void 0===E?void 0:E.map((function(e){return{key:e,value:e}})))||[]:"dictionary"===f&&(O=(O=this.props.possibleValues.dictionary.get(h)||[]).map((function(e){return{key:e.key,value:e.value&&""!==e.value?e.value:e.key}})));console.log("rowsValues = "+JSON.stringify(O));var S=u.reduce((function(e,t){var a=t[r];return e.add(a),e}),new Set),w=u.reduce((function(e,t){var a=t[n];return e.add(a),e}),new Set);console.log("columnsInDataValues = "+JSON.stringify(S)),console.log("rowsInDataValues = "+JSON.stringify(w)),b=b.filter((function(e){return S.has(e.key)})),O=O.filter((function(e){return w.has(e.key)})),console.log("columnsValues = "+JSON.stringify(b)),console.log("rowsValues = "+JSON.stringify(O));var A=u.reduce((function(e,t){var a=t[n],i=e.get(a)||{x:a};return i[t[r]]=t[s+"_"+l],e.set(a,i),e}),new Map);console.log(A);var B=o.a(A.values()).sortBy((function(e){return e.x})).toArray();console.log("dd = "+JSON.stringify(B));var x=this.props.tableState.delta&&this.props.tableState.deltaA&&this.props.tableState.deltaB,F=null!==(e=this.props.tableState.deltaTitle)&&void 0!==e?e:"\u0394",j=x&&this.props.tableState.deltaOnly;if(x){var D=this.props.tableState.deltaA,I=this.props.tableState.deltaB;B=o.a(B).map((function(e){var t=Number(e[D]),a=Number(e[I]),n=e;return n[F]=t-a,n})).toArray(),console.log("dd with delta = "+JSON.stringify(B))}if(this.props.tableState.referenceValue&&this.props.tableState.referenceOp){var P,W=null!==(P=this.props.tableState.referenceColumn)&&void 0!==P?P:"*",N=this.props.tableState.referenceValue,V=this.props.tableState.referenceOp;B=o.a(B).map((function(e){var t=Number(e[W]),a=!1;switch(V){case"eq":a=t===N;break;case"neq":a=t!==N;break;case"gt":a=t>N;break;case"lt":a=t<N;break;case"gte":a=t>=N;break;case"lte":a=t<=N}var n=e;return n.highlight=a,n})).toArray(),console.log("dd with highlight = "+JSON.stringify(B))}var z=O.reduce((function(e,t){var a=t.key,n=t.value;return e.set(a,n),e}),new Map),M=Object.fromEntries(z.entries());console.log(M);var J={field:"x",title:g,lookup:"dictionary"===f?M:void 0},_=b.map((function(e){return{field:e.key,title:e.value}})),U={field:F,title:F},G=[J].concat(j?[]:_).concat(x?U:[]).concat([{field:"highlight",title:"highlight",hidden:!0}]),Y=B,X=i.a.createElement(ze.a,{icons:kt,columns:G,onColumnDragged:function(e,t){console.log("Dropped column from "+e+" to position "+t)},options:{showTitle:!1,padding:"dense",exportAllData:!0,exportButton:!0,exportFileName:this.props.title+"."+pt()().format("YYYYMMDDTHHmmss"),fixedColumns:{left:this.props.tableState.fixed1?1:0,right:0},rowStyle:function(e){return{backgroundColor:t.state.selected===e.tableData.id?"#EEE":"#FFF",color:e.highlight?"#F00":"#000"}}},onRowClick:function(e,a){return t.setState({selected:null===a||void 0===a?void 0:a.tableData.id})},title:i.a.createElement(C.a,null,i.a.createElement(k.a,{variant:"h5",component:"h5"},this.props.title),i.a.createElement(k.a,{color:"textSecondary"},this.props.description)),isLoading:!this.state.rows&&!this.state.err,data:Y,components:{Container:function(e){return i.a.createElement(y.a,Object.assign({},e,{elevation:0}))}}});return i.a.createElement("div",{id:this.props.id},i.a.createElement(he.a,{variant:"outlined",title:this.props.title},i.a.createElement(ge.a,{action:i.a.createElement(T.a,{"aria-label":"fullscreen",onClick:this.handleFullscreenOpen},i.a.createElement(Be.a,null)),title:this.props.title,subheader:this.props.description}),i.a.createElement(fe.a,null,X),this.props.isEditMode?i.a.createElement(ye.a,{disableSpacing:!0},i.a.createElement(T.a,{"aria-label":"edit",onClick:this.handleEdit},i.a.createElement(Oe.a,null)),i.a.createElement(T.a,{"aria-label":"delete",onClick:this.handleDelete},i.a.createElement(we.a,null))):null),i.a.createElement(q.a,{fullScreen:!0,open:this.state.openFullscreen,onClose:this.handleFullscreenClose},i.a.createElement(L.a,{id:"editor-dialog-title"},i.a.createElement(be.a,{variant:"dense"},i.a.createElement(T.a,{edge:"start",color:"inherit",onClick:this.handleFullscreenClose,"aria-label":"close"},i.a.createElement(Ce.a,null)),i.a.createElement(k.a,{variant:"h6"},this.props.title))),i.a.createElement(R.a,null,i.a.createElement(k.a,{variant:"h6"},this.props.description),X)))}}]),t}(i.a.Component),St=a(487),wt=a.n(St),At=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).state={value:void 0,err:void 0,openFullscreen:!1},a.handleFullscreenOpen=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!0})}))},a.handleFullscreenClose=function(){a.setState((function(e){return Object(n.a)({},e,{openFullscreen:!1})}))},a.handleEdit=function(){console.log("handleEdit "+a.props.id),a.props.onEditWidget&&a.props.onEditWidget(a.props.id)},a.handleDelete=function(){console.log("handleDelete "+a.props.id),a.props.onDeleteWidget&&a.props.onDeleteWidget(a.props.id)},a.handleRefresh=function(){console.log("handleRefresh"),a.loadCounter()},a.loadCounter=function(){var e;console.log("WidgetCounter loadCounter "+a.props.counterState.field),a.setState({value:void 0,err:void 0});var t=a.props.api+"/api/v2/ad-query/aggregation/table",n={filter:{keys:a.props.filterItems.filter((function(e){return"set"===e.type||"dictionary"===e.type})),numbers:a.props.filterItems.filter((function(e){return"number"===e.type})).map((function(e){return{field:e.field,op:e.op,value:Number.parseFloat(e.value)}})),lists:[],period:a.props.period},groupBy:[null!==(e=a.props.counterState.fieldGroupBy)&&void 0!==e?e:a.props.counterState.field],fields:[{field:a.props.counterState.field,op:a.props.counterState.op}]},r={method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.props.token},body:JSON.stringify(n)};fetch(t,r).then((function(e){return e.json()})).then((function(e){if(1!==e.result.length)throw Error("rows in result == "+e.result.length+" "+JSON.stringify(e.result));var t,n=e.result[0][a.props.counterState.op+"_"+a.props.counterState.field];a.setState({value:n+(null!==(t=a.props.counterState.offset)&&void 0!==t?t:0)}),console.log({id:a.props.id,value:n}),console.log("WidgetCounter data="+JSON.stringify(e))})).catch((function(e){a.setState({err:e.message})}))},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){console.log("WidgetCounter componentDidMount "+this.props.counterState.field),this.loadCounter()}},{key:"componentDidUpdate",value:function(e){console.log("WidgetCounter componentDidUpdate "+this.props.counterState.field),JSON.stringify(this.props)!==JSON.stringify(e)&&this.loadCounter()}},{key:"render",value:function(){var e,t;if(this.state.err)return i.a.createElement(he.a,{variant:"outlined"},i.a.createElement(fe.a,null,i.a.createElement(k.a,null,"Error: ",this.state.err)));var a=!1;if(void 0!==this.props.counterState.referenceValue&&this.props.counterState.referenceOp){var n=this.props.counterState.referenceValue;switch(this.props.counterState.referenceOp){case"eq":a=Number(this.state.value)===n;break;case"neq":a=Number(this.state.value)!==n;break;case"gt":a=Number(this.state.value)>n;break;case"lt":a=Number(this.state.value)<n;break;case"gte":a=Number(this.state.value)>=n;break;case"lte":a=Number(this.state.value)<=n}}return i.a.createElement("div",{id:this.props.id},i.a.createElement(he.a,{variant:"outlined"},i.a.createElement(ge.a,{action:i.a.createElement(T.a,{"aria-label":"fullscreen",onClick:this.handleFullscreenOpen},i.a.createElement(Be.a,null)),color:a?"error":"textSecondary",title:this.props.title}),i.a.createElement(fe.a,null,i.a.createElement(k.a,{align:"center",variant:"h4",component:"h4",color:a?"error":"inherit"},null!==(e=this.state.value)&&void 0!==e?e:"..."),i.a.createElement(k.a,{align:"center",color:a?"error":"textSecondary"},this.props.description)),this.props.isEditMode?i.a.createElement(ye.a,{disableSpacing:!0},i.a.createElement(T.a,{"aria-label":"edit",onClick:this.handleEdit},i.a.createElement(Oe.a,null)),i.a.createElement(T.a,{"aria-label":"delete",onClick:this.handleDelete},i.a.createElement(we.a,null))):null),i.a.createElement(q.a,{fullScreen:!0,open:this.state.openFullscreen,onClose:this.handleFullscreenClose},i.a.createElement(L.a,{id:"editor-dialog-title"},i.a.createElement(be.a,{variant:"dense"},i.a.createElement(T.a,{edge:"start",color:"inherit",onClick:this.handleFullscreenClose,"aria-label":"close"},i.a.createElement(Ce.a,null)),i.a.createElement(k.a,{variant:"h6"},this.props.title),i.a.createElement(T.a,{"aria-label":"refresh","aria-haspopup":"true",edge:"end",color:"inherit",onClick:this.handleRefresh},i.a.createElement(wt.a,null)))),i.a.createElement(R.a,null,i.a.createElement("div",{style:{height:"90vh",margin:0,padding:0,display:"flex",justifyContent:"center",alignItems:"center"}},i.a.createElement("div",null,i.a.createElement(k.a,{align:"center",variant:"h1",component:"h1",color:a?"error":"inherit"},null!==(t=this.state.value)&&void 0!==t?t:"..."),i.a.createElement(k.a,{align:"center",color:a?"error":"textSecondary"},this.props.description))))))}}]),t}(i.a.Component),Bt=a(815),xt=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).handleEdit=function(){console.log("handleEdit "+a.props.id),a.props.onEditWidget&&a.props.onEditWidget(a.props.id)},a.handleDelete=function(){console.log("handleDelete "+a.props.id),a.props.onDeleteWidget&&a.props.onDeleteWidget(a.props.id)},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e;return i.a.createElement(he.a,{variant:"outlined",title:this.props.title},i.a.createElement(fe.a,null,i.a.createElement(Bt.a,null,null!==(e=this.props.description)&&void 0!==e?e:"")),this.props.isEditMode?i.a.createElement(ye.a,{disableSpacing:!0},i.a.createElement(T.a,{"aria-label":"edit",onClick:this.handleEdit},i.a.createElement(Oe.a,null)),i.a.createElement(T.a,{"aria-label":"delete",onClick:this.handleDelete},i.a.createElement(we.a,null))):null)}}]),t}(i.a.Component),Ft=a(864),jt=a(817),Dt=a.n(jt),Tt=a(488),It=a.n(Tt),Pt=a(457);var Wt=function(e){var t=l.useState(!1),a=Object(r.a)(t,2),n=a[0],i=a[1],o=l.useState(""),s=Object(r.a)(o,2),c=s[0],u=s[1];return l.createElement(y.a,{variant:"elevation",elevation:0},l.createElement(Pt.a,{title:"Show the full source of widget internals. Copy/Paste enabled."},l.createElement(T.a,{"aria-label":"raw","aria-haspopup":"true",color:"primary",onClick:function(){i(!0),u(e.raw)}},l.createElement(It.a,null))),l.createElement(q.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,maxWidth:"xs",fullWidth:!0,"aria-labelledby":"confirmation-dialog-title",open:n},l.createElement(L.a,{id:"confirmation-dialog-title"},"Raw"),l.createElement(R.a,{dividers:!0},l.createElement(g.a,{id:"value-textfield",label:"Value",size:"small",fullWidth:!0,multiline:!0,value:c,onChange:function(e){var t=e.target.value&&""!==e.target.value?e.target.value:"";console.log("new rawValue "+t),u(t)},variant:"outlined"})),l.createElement(_.a,null,l.createElement(z.a,{autoFocus:!0,onClick:function(){i(!1),u("")},color:"primary"},"Cancel"),l.createElement(z.a,{onClick:function(){i(!1),e.onChangeRaw(c),u("")},color:"primary"},"Set"))))},Nt=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).state={real:{id:Object(f.a)(),title:"New Widget 1",visualizeType:"Chart",groupBy:o.a(),filterItems:o.a([]),period:{type:"forever"}}},a.handleChangeTitle=function(e){a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{title:e})})}))},a.handleChangeDescription=function(e){a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{description:e})})}))},a.handleChange=function(e){console.log(e.target.value);var t=e.target.value;a.setState((function(e){return Object(n.a)({},e,{real:Object(n.a)({},e.real,{visualizeType:t})})}))},a.handleTimeperiod=function(e){console.log("handleTimeperiod "+e.type),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{period:{type:e.type}})})}))},a.handleAddField=function(e){console.log("handleAddField "+e.name),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{groupBy:o.a(t.real.groupBy).push(e.name)})})}))},a.handleRemoveField=function(e){console.log("handleRemoveField "+e.name),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{groupBy:t.real.groupBy.filter((function(t){return t!==e.name}))})})}))},a.handleChartChange=function(e){console.log("handleChartChange "+JSON.stringify(e)),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{chart:e})})}))},a.handleTableChange=function(e){console.log("handleTableChange "+JSON.stringify(e)),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{table:e})})}))},a.handlePivotTableChange=function(e){console.log("handlePivotTableChange "+JSON.stringify(e)),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{pivot:e})})}))},a.handleCounterChange=function(e){console.log("handleCounterChange "+JSON.stringify(e)),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{counter:e})})}))},a.handleMarkdownBottomChange=function(e){console.log("handleMarkdownBottomChange "+e),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{bottom:e})})}))},a.handleAddFilterItem=function(e){console.log("handleAddFilterItem "+JSON.stringify(e)),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{filterItems:o.a(t.real.filterItems).push(e)})})}))},a.handleRemoveFilterItem=function(e){console.log("handleRemoveFilterItem "+JSON.stringify(e)),a.setState((function(t){return Object(n.a)({},t,{real:Object(n.a)({},t.real,{filterItems:t.real.filterItems.filter((function(t){return JSON.stringify(t)!==JSON.stringify(e)}))})})}))},a.handleRaw=function(e){var t=JSON.parse(e);a.setState((function(e){return Object(n.a)({},e,{real:t})}))},a.handleEditorDialogSave=function(){a.props.onChangeWidgetEditorState(a.state.real)},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return this.props.internal.possiblePeriodsLoaded?this.props.internal.groupByAvailableLoaded?this.props.internal.possibleValuesLoaded?l.createElement("div",null,l.createElement(L.a,{id:"editor-dialog-title"},l.createElement(be.a,{variant:"dense"},l.createElement(Ft.a,{separator:"\u203a","aria-label":"breadcrumb"},l.createElement(k.a,{color:"textPrimary",title:"Create title and subtitle for the widget"},"title"),l.createElement(k.a,{color:"textPrimary",title:"Prepare query by selecting fields and filtering them"},"query"),l.createElement(k.a,{color:"textPrimary",title:"Visualize the result dataset with number of perdefined widgets"},"visualize"),l.createElement(k.a,{color:"textPrimary",title:"Preview the result dataset in widget"},"preview"),l.createElement(k.a,{color:"textPrimary",title:"Save to add widget to current dashboard"},"save")),l.createElement(T.a,{edge:"end",color:"inherit","aria-label":"help",title:"All controls have tooltips"},l.createElement(Dt.a,null)))),l.createElement(R.a,null,l.createElement(C.a,null,l.createElement(b.a,{container:!0,spacing:2,alignItems:"stretch"},l.createElement(b.a,{item:!0,xs:12},l.createElement(E,{title:this.state.real.title,description:this.state.real.description,onChangeTitle:this.handleChangeTitle,onChangeDescription:this.handleChangeDescription})),l.createElement(b.a,{item:!0,xs:12},l.createElement(Wt,{raw:JSON.stringify(this.state.real,void 0,2),onChangeRaw:this.handleRaw})),"Markdown"!==this.state.real.visualizeType?l.createElement(b.a,{item:!0,xs:12},l.createElement(Y,{groupBy:this.state.real.groupBy,groupByAvailable:this.props.internal.groupByAvailable,possibleValues:this.props.internal.possibleValues,filterItems:this.state.real.filterItems,period:this.state.real.period,possiblePeriods:this.props.internal.possiblePeriods,onAddField:this.handleAddField,onRemoveField:this.handleRemoveField,onTimeperiod:this.handleTimeperiod,onAddFilterItem:this.handleAddFilterItem,onRemoveFilterItem:this.handleRemoveFilterItem})):null,l.createElement(b.a,{item:!0,xs:12,sm:6},l.createElement(pe,{visualizeType:this.state.real.visualizeType,chart:this.state.real.chart,table:this.state.real.table,pivot:this.state.real.pivot,bottom:this.state.real.bottom,counter:this.state.real.counter,groupBy:this.state.real.groupBy,groupByAvailable:this.props.internal.groupByAvailable,possibleValues:this.props.internal.possibleValues,onChange:this.handleChange,onChartChange:this.handleChartChange,onTableChange:this.handleTableChange,onPivotTableChange:this.handlePivotTableChange,onCounterChange:this.handleCounterChange,onMarkdownBottomChange:this.handleMarkdownBottomChange})),l.createElement(b.a,{item:!0,xs:12,sm:6},"Chart"===this.state.real.visualizeType&&this.state.real.chart?l.createElement(We,{isEditMode:!1,api:this.props.api,token:this.props.token,id:this.state.real.id,title:this.state.real.title,description:this.state.real.description,chartState:this.state.real.chart,filterItems:this.state.real.filterItems,period:this.state.real.period,possibleValues:this.props.internal.possibleValues,groupByAvailable:this.props.internal.groupByAvailable}):null,"Pie"===this.state.real.visualizeType&&this.state.real.chart?l.createElement(Ne,{isEditMode:!1,api:this.props.api,token:this.props.token,id:this.state.real.id,title:this.state.real.title,description:this.state.real.description,chartState:this.state.real.chart,filterItems:this.state.real.filterItems,period:this.state.real.period,possibleValues:this.props.internal.possibleValues,groupByAvailable:this.props.internal.groupByAvailable}):null,"Table"===this.state.real.visualizeType&&this.state.real.table?l.createElement(ht,{isEditMode:!1,api:this.props.api,token:this.props.token,id:this.state.real.id,title:this.state.real.title,description:this.state.real.description,tableState:this.state.real.table,groupBy:this.state.real.groupBy,groupByAvailable:this.props.internal.groupByAvailable,filterItems:this.state.real.filterItems,period:this.state.real.period,possibleValues:this.props.internal.possibleValues}):null,"PivotTable"===this.state.real.visualizeType&&this.state.real.pivot?l.createElement(Ot,{isEditMode:!1,api:this.props.api,token:this.props.token,id:this.state.real.id,title:this.state.real.title,description:this.state.real.description,tableState:this.state.real.pivot,filterItems:this.state.real.filterItems,period:this.state.real.period,possibleValues:this.props.internal.possibleValues,groupByAvailable:this.props.internal.groupByAvailable}):null,"Events"===this.state.real.visualizeType?l.createElement(Et,{isEditMode:!1,api:this.props.api,token:this.props.token,limit:5,id:this.state.real.id,dashboardId:this.props.dashboardId,title:this.state.real.title,description:this.state.real.description,filterItems:this.state.real.filterItems,period:this.state.real.period,possibleValues:this.props.internal.possibleValues,groupByAvailable:this.props.internal.groupByAvailable}):null,"Counter"===this.state.real.visualizeType&&this.state.real.counter?l.createElement(At,{isEditMode:!1,api:this.props.api,token:this.props.token,id:this.state.real.id,title:this.state.real.title,description:this.state.real.description,counterState:this.state.real.counter,filterItems:this.state.real.filterItems,period:this.state.real.period}):null,"Markdown"===this.state.real.visualizeType?l.createElement(xt,{isEditMode:!1,id:this.state.real.id,title:this.state.real.title,description:this.state.real.description}):null)))),l.createElement(_.a,null,l.createElement(z.a,{onClick:this.props.onClose,color:"primary"},"Cancel"),l.createElement(z.a,{onClick:this.handleEditorDialogSave,color:"primary"},"Save"))):l.createElement(F,{api:this.props.api,token:this.props.token,eventFields:this.props.internal.groupByAvailable,onChangePossibleValues:this.props.onLoadPossibleValues}):l.createElement(w,{api:this.props.api,token:this.props.token,lang:this.props.lang,onChangeEventFields:this.props.onLoadEventFields}):l.createElement(j,{api:this.props.api,token:this.props.token,lang:this.props.lang,onLoadPossiblePeriods:this.props.onLoadPossiblePeriods})}}]),t}(l.Component),Vt=a(30),zt=a(489),Mt=a.n(zt),Jt=function(e){function t(){var e,a;Object(d.a)(this,t);for(var r=arguments.length,l=new Array(r),i=0;i<r;i++)l[i]=arguments[i];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(l)))).state={filterItems:o.a([]),period:{type:"forever"}},a.handleAddFilterItem=function(e){console.log("Dashboard handleAddFilterItem "+JSON.stringify(e)),a.setState((function(t){return Object(n.a)({},t,{filterItems:o.a(t.filterItems).push(e)})}))},a.handleRemoveFilterItem=function(e){console.log("Dashboard handleRemoveFilterItem "+JSON.stringify(e)),a.setState((function(t){return Object(n.a)({},t,{filterItems:t.filterItems.filter((function(t){return JSON.stringify(t)!==JSON.stringify(e)}))})}))},a.handleTimeperiod=function(e){console.log("Dashboard handleTimeperiod "+e.type),a.setState((function(t){return Object(n.a)({},t,{period:{type:e.type}})}))},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;if(0===this.props.widgets.length)return l.createElement(he.a,{variant:"outlined"},l.createElement(fe.a,null,l.createElement(k.a,null,"No widgets created"),l.createElement(k.a,null,"Use ",l.createElement(Mt.a,null)," button to select dashboard"),l.createElement(k.a,null,"Or turn on edit mode with ",l.createElement(Oe.a,null)," and use ",l.createElement(N.a,null)," button to add widget"),l.createElement(k.a,null,"\xa0"),l.createElement(k.a,null,"If something is unclear use ",l.createElement(Vt.b,{to:"/dashboard/tutorial"},"Tutorial")," "),l.createElement(k.a,null,"\xa0"),l.createElement(k.a,null,"Dashboards can be loaded from external file url, in url encoded format"),l.createElement(k.a,null,'Example: "#/inbox/dashboard/file/https%3A%2F%2Fraw.githubusercontent.com%2Favgx%2Fadd%2Fgh-pages%2Fdashboards.json"'),l.createElement(k.a,null,l.createElement(Vt.b,{to:"/inbox/dashboard/file/https%3A%2F%2Fraw.githubusercontent.com%2Favgx%2Fadd%2Fgh-pages%2Fdashboards.json"},"Click this link to see an example")),l.createElement(k.a,null,"\xa0"),l.createElement(Vt.b,{to:"/inbox/dashboard/file/https%3A%2F%2Fraw.githubusercontent.com%2Favgx%2Fadd%2Fgh-pages%2Fdashboard.demo.json"},"Click this link to load demo of all kinds of widgets for presentation")));if(!this.props.internal.possiblePeriodsLoaded)return l.createElement(j,{api:this.props.api,token:this.props.token,lang:this.props.lang,onLoadPossiblePeriods:this.props.onLoadPossiblePeriods});if(!this.props.internal.groupByAvailableLoaded)return l.createElement(w,{api:this.props.api,token:this.props.token,lang:this.props.lang,onChangeEventFields:this.props.onLoadEventFields});if(!this.props.internal.possibleValuesLoaded)return l.createElement(F,{api:this.props.api,token:this.props.token,eventFields:this.props.internal.groupByAvailable,onChangePossibleValues:this.props.onLoadPossibleValues});console.log("Dashboard widgets: "+JSON.stringify(this.props.widgets,void 0,2));var t=o.a(this.props.widgets).filter((function(e){return"Markdown"===e.visualizeType&&!e.bottom})),a=o.a(this.props.widgets).filter((function(e){return"Markdown"===e.visualizeType&&e.bottom})),n=o.a(this.props.widgets).filter((function(e){return"Chart"===e.visualizeType})),r=o.a(this.props.widgets).filter((function(e){return"Pie"===e.visualizeType})),i=o.a(this.props.widgets).filter((function(e){return"Counter"===e.visualizeType})),s=o.a(this.props.widgets).filter((function(e){return"Table"===e.visualizeType})),c=o.a(this.props.widgets).filter((function(e){return"PivotTable"===e.visualizeType})),u=o.a(this.props.widgets).filter((function(e){return"Events"===e.visualizeType}));return l.createElement("div",null,l.createElement(k.a,{variant:"subtitle2"},"\xa0"),this.props.isCommonFilterEnabled?l.createElement(Pt.a,{title:"Dashboard common filter that will be applied to every widget"},l.createElement(b.a,{container:!0,spacing:2,direction:"row",alignItems:"stretch",alignContent:"center"},l.createElement(b.a,{item:!0},l.createElement(G,{period:this.state.period,possiblePeriods:this.props.internal.possiblePeriods,onTimeperiod:this.handleTimeperiod})),l.createElement(b.a,{item:!0},l.createElement(U,{filterItems:this.state.filterItems,possibleValues:this.props.internal.possibleValues,groupByAvailable:this.props.internal.groupByAvailable,onAddFilterItem:this.handleAddFilterItem,onRemoveFilterItem:this.handleRemoveFilterItem})))):null,l.createElement(b.a,{container:!0,spacing:2,alignItems:"stretch"},t.map((function(t){return l.createElement(b.a,{item:!0,xs:12},l.createElement(xt,{isEditMode:e.props.isEditMode,id:t.id,title:t.title,description:t.description,onEditWidget:e.props.onEditWidget,onDeleteWidget:e.props.onDeleteWidget}))}))),l.createElement(b.a,{container:!0,spacing:2,alignItems:"stretch"},i.map((function(t){return l.createElement(b.a,{item:!0,xs:12,sm:3},l.createElement(At,{isEditMode:e.props.isEditMode,api:e.props.api,token:e.props.token,id:t.id,title:t.title,description:t.description,counterState:t.counter,filterItems:e.props.isCommonFilterEnabled?o.a(t.filterItems).concat(e.state.filterItems):t.filterItems,period:e.props.isCommonFilterEnabled?e.state.period:t.period,refreshTime:e.props.refreshTime,onEditWidget:e.props.onEditWidget,onDeleteWidget:e.props.onDeleteWidget}))}))),l.createElement(b.a,{container:!0,spacing:2,alignItems:"stretch"},n.map((function(t){return l.createElement(b.a,{item:!0,xs:12,sm:6},l.createElement(We,{isEditMode:e.props.isEditMode,api:e.props.api,token:e.props.token,id:t.id,title:t.title,description:t.description,chartState:t.chart,filterItems:e.props.isCommonFilterEnabled?o.a(t.filterItems).concat(e.state.filterItems):t.filterItems,period:e.props.isCommonFilterEnabled?e.state.period:t.period,possibleValues:e.props.internal.possibleValues,groupByAvailable:e.props.internal.groupByAvailable,refreshTime:e.props.refreshTime,onEditWidget:e.props.onEditWidget,onDeleteWidget:e.props.onDeleteWidget}))})),r.map((function(t){return l.createElement(b.a,{item:!0,xs:12,sm:6},l.createElement(Ne,{isEditMode:e.props.isEditMode,api:e.props.api,token:e.props.token,id:t.id,title:t.title,description:t.description,chartState:t.chart,filterItems:e.props.isCommonFilterEnabled?o.a(t.filterItems).concat(e.state.filterItems):t.filterItems,period:e.props.isCommonFilterEnabled?e.state.period:t.period,possibleValues:e.props.internal.possibleValues,groupByAvailable:e.props.internal.groupByAvailable,refreshTime:e.props.refreshTime,onEditWidget:e.props.onEditWidget,onDeleteWidget:e.props.onDeleteWidget}))}))),l.createElement(k.a,{variant:"subtitle2"},"\xa0"),l.createElement(b.a,{container:!0,spacing:2,alignItems:"stretch"},s.map((function(t){return l.createElement(b.a,{item:!0,xs:12},l.createElement(ht,{isEditMode:e.props.isEditMode,api:e.props.api,token:e.props.token,id:t.id,title:t.title,description:t.description,tableState:t.table,groupBy:t.groupBy,groupByAvailable:e.props.internal.groupByAvailable,filterItems:e.props.isCommonFilterEnabled?o.a(t.filterItems).concat(e.state.filterItems):t.filterItems,period:e.props.isCommonFilterEnabled?e.state.period:t.period,possibleValues:e.props.internal.possibleValues,refreshTime:e.props.refreshTime,onEditWidget:e.props.onEditWidget,onDeleteWidget:e.props.onDeleteWidget}))})),c.map((function(t){return l.createElement(b.a,{item:!0,xs:12},l.createElement(Ot,{isEditMode:e.props.isEditMode,api:e.props.api,token:e.props.token,id:t.id,title:t.title,description:t.description,tableState:t.pivot,filterItems:e.props.isCommonFilterEnabled?o.a(t.filterItems).concat(e.state.filterItems):t.filterItems,period:e.props.isCommonFilterEnabled?e.state.period:t.period,possibleValues:e.props.internal.possibleValues,groupByAvailable:e.props.internal.groupByAvailable,refreshTime:e.props.refreshTime,onEditWidget:e.props.onEditWidget,onDeleteWidget:e.props.onDeleteWidget}))})),u.map((function(t){return l.createElement(b.a,{item:!0,xs:12},l.createElement(Et,{isEditMode:e.props.isEditMode,api:e.props.api,token:e.props.token,limit:200,id:t.id,dashboardId:e.props.id,title:t.title,description:t.description,filterItems:e.props.isCommonFilterEnabled?o.a(t.filterItems).concat(e.state.filterItems):t.filterItems,period:e.props.isCommonFilterEnabled?e.state.period:t.period,possibleValues:e.props.internal.possibleValues,groupByAvailable:e.props.internal.groupByAvailable,refreshTime:e.props.refreshTime,onEditWidget:e.props.onEditWidget,onDeleteWidget:e.props.onDeleteWidget}))}))),l.createElement(b.a,{container:!0,spacing:2,alignItems:"stretch"},a.map((function(t){return l.createElement(b.a,{item:!0,xs:12},l.createElement(xt,{isEditMode:e.props.isEditMode,id:t.id,title:t.title,description:t.description,onEditWidget:e.props.onEditWidget,onDeleteWidget:e.props.onDeleteWidget}))}))))}}]),t}(l.Component);var Lt=function(e){var t=l.useState(!1),a=Object(r.a)(t,2),n=a[0],i=a[1],o=l.useState(""),s=Object(r.a)(o,2),c=s[0],u=s[1];return l.createElement("div",null,l.createElement(Pt.a,{title:"Show the full source of dashboard internals. Copy/Paste enabled."},l.createElement(T.a,{"aria-label":"raw","aria-haspopup":"true",color:"inherit",onClick:function(){i(!0),u(e.raw)}},l.createElement(It.a,null))),l.createElement(q.a,{disableBackdropClick:!0,disableEscapeKeyDown:!0,maxWidth:"xs",fullWidth:!0,"aria-labelledby":"confirmation-dialog-title",open:n},l.createElement(L.a,{id:"confirmation-dialog-title"},"Raw"),l.createElement(R.a,{dividers:!0},l.createElement(g.a,{id:"value-textfield",label:"Value",size:"small",fullWidth:!0,multiline:!0,value:c,onChange:function(e){var t=e.target.value&&""!==e.target.value?e.target.value:"";console.log("new rawValue "+t),u(t)},variant:"outlined"})),l.createElement(_.a,null,l.createElement(z.a,{autoFocus:!0,onClick:function(){i(!1),u("")},color:"primary"},"Cancel"),l.createElement(z.a,{onClick:function(){i(!1),e.onChangeRaw(c),u("")},color:"primary",disabled:e.isReadonly},"Set"))))},Rt=a(858),_t=a(860);var qt=function(e){var t=l.useState(!1),a=Object(r.a)(t,2),n=a[0],i=a[1],o=function(){i(!1)};return l.createElement("div",null,l.createElement(Pt.a,{title:"Create new or select one of the predefined dashboards"},l.createElement(T.a,{edge:"start",disabled:e.isEditMode,color:"inherit","aria-label":"menu",onClick:function(){i(!0)}},l.createElement(Mt.a,null))),l.createElement(q.a,{onClose:o,"aria-labelledby":"simple-dialog-title",maxWidth:"xs",fullWidth:!0,open:n},l.createElement(L.a,{id:"simple-dialog-title"},"Dashboard"),l.createElement(te.a,null,l.createElement(ae.a,{button:!0,component:Vt.c,to:"/dashboard",onClick:function(){return t="Dashboard",a=[],i(!1),void e.onSelectWidgets(t,a);var t,a},key:Object(f.a)()},l.createElement(ne.a,{primary:"Create new ..."})),l.createElement(Rt.a,null),l.createElement(_t.a,null,"or select"),e.list.map((function(e){return l.createElement(ae.a,{button:!0,component:Vt.c,to:"/dashboard/"+e.id,onClick:o,key:e.id},l.createElement(ne.a,{primary:e.title}))})))))},Ut=a(309),Gt=a(857),Yt=a(820),Xt=a.n(Yt),Ht=a(821),Qt=a.n(Ht),Kt=a(2);var Zt=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(m.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={data:void 0,err:void 0},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(this.props.dashboardsJsonUrl).then((function(e){return e.json()})).then((function(e){return function(e,t){return new Promise((function(a){return setTimeout(a,e,t)}))}(2e3,e)})).then((function(t){t.length>0?(e.props.onLoadedDashboards(t),e.setState({data:t})):e.setState({err:"No dashboards found in "+e.props.dashboardsJsonUrl})})).catch((function(t){e.setState({err:t.message})}))}},{key:"render",value:function(){return this.state.err?l.createElement("div",null,l.createElement(C.a,null,l.createElement(k.a,null,"Error: ",this.state.err),l.createElement(k.a,null,l.createElement(Vt.b,{to:"/"},"Return to dashboards")))):this.state.data?l.createElement(Kt.a,{to:"/"}):l.createElement("div",{style:{height:"90vh",margin:0,padding:0,display:"flex",justifyContent:"center",alignItems:"center"}},l.createElement(S.a,null),"\xa0\xa0Loading dashboard from ",this.props.dashboardsJsonUrl,"...")}}]),t}(l.Component),$t=a(818),ea=a(819);Te.a.vfs=Pe.a.pdfMake.vfs;var ta=Object(c.a)((function(e){return Object(u.a)({root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}})}));t.default=function(){var e=ta(),t=Object(Kt.g)(),a=t.dashboardId,l=(t.widgetId,t.widgetMode,t.eventId,t.dashboardFile),c=$t,u=i.a.useState(c),d=Object(r.a)(u,2),p=d[0],m=d[1],v=ea,h=i.a.useState("Dashboards"),f=Object(r.a)(h,2),y=f[0],b=f[1],E=i.a.useState(!1),C=Object(r.a)(E,2),O=C[0],S=C[1],w=i.a.useState("https://axxoncloud-test2.axxonnet.com"),A=Object(r.a)(w,2),B=A[0],x=A[1],F=i.a.useState("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVc2VySUQiOjUzLCJVc2VyTmFtZSI6ImF6cmV0LnNoYXVsdWtob3ZAcnUuYXh4b25zb2Z0LmNvbSIsIkNsaWVudElEIjoiNmNlZGQ2OTJjNTNiNWRmMGNkZGVjNjlmMmYxNzZhMDgiLCJUeXBlIjoiYWNjZXNzVG9rZW4iLCJWZXJzaW9uIjoidjIiLCJDcmVhdGVkQXQiOiIyMDIwLTA2LTMwVDEzOjQxOjM5LjkzNDEyNjg4MVoiLCJleHAiOjE1OTM2MTA4OTksImlhdCI6MTU5MzUyNDQ5OSwiaXNzIjoiQ2xvdWQifQ.H9HnJkqvF3DdTa9hTmqxbzx0KBE5roaOic4rQqzTzkk"),j=Object(r.a)(F,2),D=j[0],I=j[1],W=i.a.useState("en"),V=Object(r.a)(W,2),M=V[0],J=V[1],U=i.a.useState(!0),G=Object(r.a)(U,2),Y=G[0],X=G[1],K=i.a.useState(new Date),Z=Object(r.a)(K,2),$=Z[0],ee=Z[1],te=i.a.useState(!1),ae=Object(r.a)(te,2),ne=ae[0],re=ae[1],le=i.a.useState(!1),ie=Object(r.a)(le,2),oe=ie[0],se=ie[1],ce=function(){re(!1)},ue=function(){se(!1)},de=function(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(t){return null}}(D);console.log("tokenParsed: "+JSON.stringify(de));var pe=JSON.stringify(de),me=i.a.useState([]),ve=Object(r.a)(me,2),he=ve[0],fe=ve[1],ge=i.a.useState({groupByAvailableLoaded:!1,groupByAvailable:[],possibleValuesLoaded:!1,possibleValues:{set:o.b({}),dictionary:o.b({})},possiblePeriodsLoaded:!1,possiblePeriods:[]}),ye=Object(r.a)(ge,2),Ee=ye[0],Ce=ye[1],ke=function(e){console.log("handleLoadEventFields "+JSON.stringify(e));var t=e.sort((function(e,t){var a=e.translation.toUpperCase(),n=t.translation.toUpperCase(),r=0;return a>n?r=1:a<n&&(r=-1),r}));Ce(Object(n.a)({},Ee,{groupByAvailableLoaded:!0,groupByAvailable:t}))},Se=function(e){console.log("handleLoadPossibleValues "+JSON.stringify(e)),Ce(Object(n.a)({},Ee,{possibleValuesLoaded:!0,possibleValues:e}))},we=function(e){console.log("handleLoadPossiblePeriods "+JSON.stringify(e)),Ce(Object(n.a)({},Ee,{possiblePeriodsLoaded:!0,possiblePeriods:e}))};if(l)return i.a.createElement(Zt,{dashboardsJsonUrl:decodeURIComponent(l),onLoadedDashboards:function(e){console.log("handleonLoadedDashboards length="+e.length),m(e)}});var Ae=function(e){var t=JSON.parse(e);fe(t)},Be=function(e){console.log("TODO: implement handleEditWidget")},xe=function(e){fe(he.filter((function(t){return t.id!==e})))};return i.a.createElement("div",{className:e.root},i.a.createElement(Ut.a,{display:"block",displayPrint:"none"},i.a.createElement(s.a,{position:"static"},i.a.createElement(be.a,{variant:"dense"},i.a.createElement(qt,{list:p,isEditMode:O,onSelectWidgets:function(e,t){fe(t),b(e)}}),i.a.createElement(k.a,{variant:"h6",className:e.title},y," ",O?" : Edit":""),O&&!a?i.a.createElement(Pt.a,{title:"Add widget"},i.a.createElement(T.a,{edge:"end",color:"inherit","aria-label":"add widget",onClick:function(){se(!0)}},i.a.createElement(N.a,null))):null,O?i.a.createElement((function(){var e=Object(Kt.g)().dashboardId;if(!e)return i.a.createElement(Lt,{isReadonly:!1,raw:JSON.stringify(he,void 0,2),onChangeRaw:Ae});var t=o.a(p).find((function(t){return t.id===e}));if(!t)return null;var a=t.raw;return i.a.createElement(Lt,{isReadonly:!0,raw:JSON.stringify(a,void 0,2),onChangeRaw:Ae})}),null):null,he.length>0?i.a.createElement(Pt.a,{title:"Refresh data"},i.a.createElement(T.a,{"aria-label":"refresh","aria-haspopup":"true",color:"inherit",onClick:function(){ee(new Date)}},i.a.createElement(wt.a,null))):null,!O&&he.length>0?i.a.createElement(Pt.a,{title:"Export"},i.a.createElement(T.a,{"aria-label":"export","aria-haspopup":"true",color:"inherit",onClick:function(){console.log("TODO: EXPORT");for(var e=[],t=0;t<he.length;t++){var a=he[t];if(a.id){var n=document.getElementById(a.id);if(console.log(n),n){var r=n.querySelector("svg.recharts-surface");if(console.log(r),null!=r){var l,i=(new XMLSerializer).serializeToString(r);e.push({text:a.title},{text:null!==(l=a.description)&&void 0!==l?l:""},{text:"raw: "+JSON.stringify(a)},{svg:i,width:500})}else e.push({text:"no svg for "+a.visualizeType+" "+a.title})}else e.push({text:"no widgetRoot for "+a.visualizeType+" "+a.title})}else e.push({text:"no id for "+a.visualizeType+" "+a.title})}var o={header:"Export (ugly but fixing is in progress)",footer:function(e,t){return{text:"Created at "+new Date,alignment:"center"}},content:e};Te.a.createPdf(o).download(y+"."+pt()().format("YYYYMMDDTHHmmss")+".pdf")}},i.a.createElement(Xt.a,null))):null,O?i.a.createElement(Pt.a,{title:"Show settings dialog"},i.a.createElement(T.a,{"aria-label":"backend","aria-haspopup":"true",color:"inherit",onClick:function(){re(!0)}},i.a.createElement(Qt.a,null))):null,i.a.createElement(Pt.a,{title:"Toggle edit mode"},i.a.createElement(T.a,{"aria-label":"edit-mode","aria-haspopup":"true",color:"inherit",onClick:function(){S(!O)}},i.a.createElement(Oe.a,{color:O?"secondary":"inherit"})))))),i.a.createElement((function(){var e;if(!a)return i.a.createElement(Jt,{id:"custom",api:B,token:D,lang:M,isCommonFilterEnabled:Y,isEditMode:O,refreshTime:$,widgets:he,internal:Ee,onLoadEventFields:ke,onLoadPossibleValues:Se,onLoadPossiblePeriods:we,onEditWidget:Be,onDeleteWidget:xe});var t=null!==(e=o.a(p).find((function(e){return e.id===a})))&&void 0!==e?e:o.a(v).find((function(e){return e.id===a}));if(!t)return i.a.createElement(k.a,null,"Dashboard ",a," not found");var n=t.raw;return i.a.createElement(Jt,{id:t.id,api:B,token:D,lang:M,isCommonFilterEnabled:Y,isEditMode:O,refreshTime:$,widgets:n,internal:Ee,onLoadEventFields:ke,onLoadPossibleValues:Se,onLoadPossiblePeriods:we,onEditWidget:Be,onDeleteWidget:xe})}),null),i.a.createElement(q.a,{open:ne,onClose:ce,"aria-labelledby":"backend-dialog-title"},i.a.createElement(L.a,{id:"backend-dialog-title"},"Backend"),i.a.createElement(R.a,null,i.a.createElement(Gt.a,null,"To get data need url and token"),i.a.createElement(g.a,{autoFocus:!0,margin:"dense",id:"backend-api",label:"API",type:"url",value:B,fullWidth:!0,onChange:function(e){console.log("handleApi "+e.target.value),x(e.target.value)}}),i.a.createElement(g.a,{id:"op-value-textfield",margin:"dense",label:"lang",size:"small",select:!0,fullWidth:!0,value:M,onChange:function(e){console.log("handleLang "+e.target.value);var t=e.target.value;J(t)}},i.a.createElement(P.a,{key:"en",value:"en"},"en"),i.a.createElement(P.a,{key:"ru",value:"ru"},"ru")),i.a.createElement(H.a,{control:i.a.createElement(Q.a,{checked:Y,onChange:function(e){console.log("handleCommonFilter "+e.target.value);var t=e.target.checked;X(t)},size:"small"}),label:"Dashboard common filter"}),i.a.createElement(g.a,{autoFocus:!0,margin:"dense",id:"backend-token",label:"Access token",value:D,multiline:!0,fullWidth:!0,helperText:pe,onChange:function(e){console.log("handleToken "+e.target.value),I(e.target.value)}})),i.a.createElement(_.a,null,i.a.createElement(z.a,{onClick:ce,color:"primary"},"Cancel"),i.a.createElement(z.a,{onClick:ce,color:"primary"},"OK"))),i.a.createElement(q.a,{fullScreen:!0,open:oe,onClose:ue,fullWidth:!0,maxWidth:"xl","aria-labelledby":"editor-dialog-title"},i.a.createElement(Nt,{dashboardId:null!==a&&void 0!==a?a:"custom",api:B,token:D,lang:M,internal:Ee,onLoadEventFields:ke,onLoadPossibleValues:Se,onLoadPossiblePeriods:we,onChangeWidgetEditorState:function(e){console.log("handleChangeWidgetEditorState "+a+" "+JSON.stringify(e)),fe(o.a(he).push(e).toArray()),se(!1)},onClose:ue})))}}}]);
//# sourceMappingURL=4.8ce4fe1a.chunk.js.map